#+TITLE: Deformations of Permutahedra
#+AUTHOR: Long Huynh Huu
#+EMAIL: long@huynhgia.de
#+LANGUAGE: en
#+OPTIONS: ':t toc:t author:t email:t d:(not "NOTES", not "HIDDEN")
:LATEX_DATA:
#+LATEX_CLASS: koma-article
#+LATEX_CLASS_OPTIONS: [10pt, a4paper, oneside, headinclude,footinclude, BCOR=5mm]
#+LATEX_HEADER: \input{latex/preamble.tex}
#+LATEX_HEADER: \usepackage{stmaryrd}
#+LATEX_HEADER: \input{latex/custom-commands.tex}
#+LATEX_HEADER: \usepackage{tikz}
#+LATEX_HEADER: \usepackage{natbib}
#+LATEX_HEADER: \usepackage{makeidx}
#+LATEX_HEADER: \makeindex
#+LATEX_HEADER: \usepackage[totoc,unbalanced]{idxlayout}
:END:

* Documentation                                                    :noexport:
The Yak must be shaven.

* Abstract
:PROPERTIES:
:UNNUMBERED: t
:END:
#+LATEX: \addcontentsline{toc}{section}{Abstract}

#+BEGIN_QUOTE
Je n'ai fait celle-ci plus longue que parce que je n'ai pas eu le loisir de la faire plus courte.
-- Blaise Pascal
#+END_QUOTE

* Notation
:PROPERTIES:
:UNNUMBERED: t
:END:
#+LATEX: \addcontentsline{toc}{section}{Notation}

- \( \Vertices P \): the set of vertices of a polytope \( P \)
  #+index: \( \Vertices P \)
- \( \Edges P \): set of line segments \( [v, w] \) which are edges of a polytope \( P \)
  #+index: \( \Edges P \)
- \( \Graph P \): graph of \( P \) with vertices \( \Vertices P \) and edges \( \Set{ \{v,w\} }{ [v,w] \in \Edges P } \)
  #+index: \( \Graph P \)
- \( \Face(P,c) \): set of maximisers in \( P \) of the linear functional \( c \)
  #+index: \( \Face(P,c) \)
- \( \FaceLattice(P) \): face lattice of \( P \)
  #+index: \( \FaceLattice \)
- \( N^M \): the set of functions \( M \to N \) where \( M, N \) are sets
  #+index: \( N^M \)
- \( \Powerset{M} \): the power set of \( M \)
  #+index: \( \Powerset{M} \)
- \( \Card{M} \): the cardinality of a set \( M \)
  #+index: \( \#M \)
- \( \defeq \): equality by definition
  #+index: \( \defeq \)
- \( \ConeHull(X) \): convex cone generated by the points \( X \)
  #+index: \( \ConeHull(...) \)
- \( \ConvexHull(X) \): convex hull of points \( X \)
  #+index: \( \ConvexHull(...) \)
- \( \Polytopes(\mathbb{R}^n) \): set of all polytopes in \( \mathbb{R}^n \)
  #+index: \( \Polytopes(\mathbb{R}^n) \)
- \( \NormalFan P \): normal fan of a polytope \( P \)
  #+index: \( \NormalFan P \)
- \( \NormalCone(F,P) \): normal cone of a face \( F \) of a polytope \( P \)
  #+index: \( \NormalCone(F,P) \)
- \( \TangentCone(v,P) \): tangent cone of a polytope \( P \) at vertex \( v \)
  #+index: \( \TangentCone(v,P) \)
* Conventions
:PROPERTIES:
:UNNUMBERED: t
:END:
#+LATEX: \addcontentsline{toc}{section}{Conventions}

- Polytopes are convex
- Cones are convex
* Deformations of a polytope
** Introduction

Given a polytope we want to study its deformations.
Deformations are obtained by extending or contracting edges without changing their directions.

#+begin_definition
Let \( P, Q \subset \mathbb{R}^n \) be polytopes.
\( Q \) is called a /deformation/ of \( P \) if there exist
#+index: deformation

- a surjective map \( \phi : \Vertices{P} \to \Vertices{Q} \) and
- a non-negative map \( \lambda : \Edges{P} \to \mathbb{R} \)

such that
\( \phi(v) - \phi(w) = \lambda([v,w])(v-w) \) for all edges \( [v,w] \in \Edges{P} \).
#+end_definition

We will employ three different views on deformations of polytopes and show their equivalence
- deformations as polytopes obtained by stretching edges without changing their direction
- deformations as Minkowski summands
- deformations as polytopes obtained by modifying the right-hand side of an H-representation without introducing new edge directions

** Abstract cones
*** The category of abstract cones
 While the set \( \Polytopes(\mathbb{R}^n) \) of all polytopes in \( \mathbb{R}^n \) does not admit the structure of a vector space, we will deal with several descriptions of the set of all deformations of a polytope, which happen to be cones, i.e. subsets of a real vector space closed under addition and multiplication by non-negative real numbers.
 #+index: \( \Polytopes \)
 This suggests that we should treat the set \( \DefCone_P \) of all deformations of \( P \), which we call the /deformation cone/ of \( P \), as a cone.
 #+index: deformation cone
 The addition operation will be given by Minkowski summation:
 #+index: Minkowski sum
 \[ \forall P, Q \in \DefCone_P:\, P+Q \defeq \Set{ x+y}{x\in P, y \in Q} \in \DefCone_P \]
 and scalar multiplication by non-negative scalars by central dilation:
 #+index: dilation
 \[ \forall P \in \DefCone_P, \lambda \geq 0:\, \lambda P \defeq \Set{ \lambda x }{ x \in P } \in \DefCone_P \]

 In order to make this precise, we can either construct a vector space in which \( \DefCone_P \) resides or we axiomatise the concept of a cone.
 We have explored the first option in the appendix, section \ref{appendix:virtual-polytopes}, but decided to work with the second one.

 #+begin_definition
 #+index: abstract cone
 A commutative monoid \( C \) together with a multiplication \( \cdot : \mathbb{R}_+ \times C \to C \) is called a cone if for all \( c,c',c'' \in C \) and \( \lambda, \mu \in \mathbb{R}_+ \):
 - \( 1c = c \),
 - \( (\lambda+\mu)c = \lambda c + \mu c \),
 - \(\lambda(c+c') = \lambda c + \lambda c' \),
 - \( \lambda(\mu c) = (\lambda\mu)c \),
 - \( C \) admits cancellation, that is, \( c+c'' = c+c' \) implies \( c'' = c' \).
 #+end_definition

 A priori we do not have a notion of subtraction for such cones, but we may define \( c-c' \) to be the unique element \( c'' \) satisfying \( c'' + c' = c \).

 Now that we have defined the objects, we need to define morphisms of cones as well.

 #+begin_definition
 Let \( C,D \) be cones.
 A function \( \phi : C \to D \) is called a /(cone) morphism/ if, for all \( c,c' \in C \) and \( \lambda \geq 0 \)
 \[ \phi(c+\lambda c') = \phi(c) + \lambda\phi(c') \]
 If \( \phi \) has an inverse which is also a cone morphism, then we call \( \phi \) a /(cone) isomorphism/.
 #+index: cone morphism
 #+end_definition

 #+begin_lemma
 The composition \( f\circ g \) of two cone morphisms \( g : C' \to C \) and \( f : C \to C'' \) is again a cone morphism.
 #+end_lemma
 #+begin_proof
 For all \( c_1,c_2 \in C' \) and \( \lambda \geq 0 \) we have \( f(g(c_1+\lambda c_2)) = f(g(c_1)+\lambda g(c_2)) = f(g(c_1)) + \lambda f(g(c_2)) \).
 #+end_proof


 #+begin_lemma
 If \( f : C \to D \) is a bijective cone morphisms, then it is already an isomorphism.
 #+end_lemma
 #+begin_proof
 Let \( g \) be the inverse of \( f \).
 Then for all \( c,c' \in C, \lambda \geq 0 \) we have \( g(c+\lambda c') = g(f(g(c)) + \lambda g(f(c'))) = g(f(g(c)+\lambda g(c')) = g(c) + \lambda g(c') \).
 #+end_proof

#+begin_remark
The category of abstract cones has also been studied in cite:valby2006category.
The notion of an abstract cone should not be confused with the notion of a cone of a functor in the category theoretic sense.
#+end_remark
*** Linear completion
Every abstract cone turns out to be a cone in the usual sense, living in some real vector space.
In the appendix, section \ref{appendix:vector-space-of-cone}, we show the existence of the /linear completion/ \( \mathbb{R}C \) of an abstract cone \( C \).

#+begin_definition
Let \( C \) be an abstract cone.
A cone morphism \( \theta : C \to E \) into a vector space \( E \) is said to satisfy the /universal property of linear completion/ if for every morphism \( \phi : C \to E' \) into a vector space \( E' \) there exists a unique linear map \( \phi' : E \to E' \) such that \( \phi = \phi'\circ \theta \).
#+index: linear completion
#+index: linear completion ! universal property
#+end_definition

It turns out that \( \theta \) in the universal property is injective, so we may assume \( C \subseteq \mathbb{R}C \).
Here are a few conclusions which give us a clearer picture of how abstract cones look like.

#+begin_corollary
Every abstract cone can be realised as a cone in some vector space.
#+end_corollary

#+begin_proof
\( C \subseteq \mathbb{R}C \) is a subset closed under addition and multiplication by non-negative scalars, i.e. a cone.
#+end_proof

#+begin_corollary
A morphism of abstract cones extends to a homomorphism of vector spaces.
#+end_corollary

#+begin_proof
Let \( \phi : C \to C' \) be a morphism of abstract cones, then \( C \to C' \to \mathbb{R}C' \) is a morphism of abstract cones as well and induces uniquely \( \mathbb{R}C \to \mathbb{R}C' \).
#+end_proof

#+begin_corollary
We define the dimension of an abstract cone \( C \) to be \( \dim \mathbb{R}C \).
This definition agrees with the definition of dimension in case \( C \subseteq V \) is a cone in some real vector space \( V \).
#+end_corollary

#+begin_proof
The cone \( C \subseteq \mathbb{R}C \) is full-dimensional, because every element of \( \mathbb{R}C \) can be written as difference of elements in \( C \).
#+end_proof

There is a simpler description of linear completion.
#+begin_proposition
Let \( C \) be an abstract cone embedded as full-dimensional cone into a vector space \( E \).
Then \( E \) is the linear completion.
#+end_proposition

#+begin_proof
As \( C \) is full-dimensional in \( E \), so \( C \) contains a basis of \( E \).
In particular every element of \( E \) can be written as \(  c - c' \) for \( c,c' \in C \)
and every morphism of cones \( C \to E' \) into a vector space \( E' \) is determined by the image of the basis,
and hence extends to a unique linear homomorphism \( E \to E' \).
#+end_proof

All in all, notions which make sense for cones, like dimension, facets, rays, lineality space, triangulation, etc. also make sense for abstract cones.
** The vertex-edge deformation cone
*** Definition
#+index: vertex-edge deformation cone
#+index: deformation cone ! vertex-edge def. cone

Let \( P \subset \mathbb{R}^n \) be a polytope.
From the definition of a deformation it is apparent that determining all deformations of \( P \) can be reformulated as finding solutions of a system of linear equalities and inequalities.

#+begin_definition
The vertex-edge deformation cone \( \VertexEdgeCone_P \) of \( P \) is defined as set of pairs \( (x,t) \in (\mathbb{R}^n)^{\Vertices P} \times \mathbb{R}^{\Edges P} \) satisfying, for all \( [v,w] \in \Edges P \),
#+index: \( \VertexEdgeCone \) \see{vertex-edge deformation cone}

\begin{align}
  x(v) - x(w) - t([v,w])(v-w) =& 0 \label{eq:ve1} \\
  t([v,w])                 \geq& 0 \label{eq:ve2}
\end{align}
#+end_definition

The definition immediately tells us that the vertex-edge deformation cone is indeed a cone, and also that every deformation can be uniquely described as an element of that cone.
The converse is true as well, that is, 

#+begin_proposition
\label{prop:vertex-edge-cone}
Let \( P \) be a polytope and \( (x,t) \in \VertexEdgeCone_P \).
Then for every vertex \( v \in P \), \( x(v) \) is a vertex of

\[ P^{(x,t)} \defeq \ConvexHull\Set{ x(v) }{ v \in \Vertices P } \]
#+index: \( P^{(x,t)} \)

In particular \( P^{(x,t)} \defeq \ConvexHull\Set{ x(v) }{ v \in \Vertices P } \) is a deformation.
#+end_proposition

The proposition follows directly from the following lemma.

#+begin_lemma
[Monotonicity]
\label{lem:monotonicity}
#+index: monotonicity lemma
Let \( P \) be a polytope with vertex \( v \) and \( (x,t) \in \VertexEdgeCone_P \).
If \( v \in P \) is the unique maximiser of a functional \( c \in \mathbb{R}^{n*} \) over \( P \), \( \forall w \in P\setminus \{ v \}:\, cv > cw, \)
then \( x(v) \) maximises \( c \) over \( P^{(x,t)} \) uniquely, \( \forall w \in P^{(x,t)} \setminus \{ x(v) \}:\, cxv > cw. \)
If \( v \in P \) is only some maximiser of a functional \( c \in \mathbb{R}^{n*} \) over \( P \), \( \forall w \in P:\, cv \geq cw, \)
then \( x(v) \) still maximises \( c \) over \( P^{(x,t)} \), \( \forall w \in P^{(x,t)}:\, cxv \geq cw. \)
#+end_lemma
#+begin_proof
Let \( v' \in P \) be a vertex such that \( x(v') \neq x(v) \).
The simplex algorithm, for whose description we refer to [[cite:schrijver86_theory_of_ilp][Section 11]], yields a sequence \( v_0v_1...v_l \) of vertices such that

- \( v_0 = v' \) and \( v_l = v \)
- \( [v_{i},v_{i-1}] \in \Edges P \) for all \( i \in [l] \)
- \( c(v_i) - c(v_{i-1}) > 0 \) for all \( i \in [l] \)

Hence \( x(v) = x(v') + \sum_{i=1}^l x(v_{i})-x(v_{i-1}) = x(v') + \sum_{i=1}^l t([v_i,v_{i-1}])(v_{i}-v_{i-1})\).
We have excluded the case \( xv = xv' \), so at least some \( t([v_i,v_{i-1}]) > 0 \)
and because \( t([v_{i},v_{i-1}]) \) and \( c(v_i - v_{i-1}) \) are both positive,
\[ c(x(v)) = c(x(v')) + \sum_{i=1}^l t([v_{i},v_{i-1}])c(v_i - v_{i-1}) > c(x(v')). \]
The second assertion follows similarly.
#+end_proof

Finally we want to relate the vertex-edge deformation cone with the deformation cone.

#+begin_corollary
\label{cor:xi-isomorphism}
Let \( P \subset \mathbb{R}^n \) be a polytope.
Then the deformation cone \( \DefCone_P \) and the vertex-edge deformation cone \( \VertexEdgeCone_P \) are isomorphic via \( \xi : \VertexEdgeCone \to \DefCone_P, (x,t) \mapsto P^{(x,t)} \).
#+end_corollary

#+begin_proof
By Proposition \ref{prop:vertex-edge-cone}, \( \xi \) is well-defined and we have established that \( \xi \) is surjective.
To show injectivity, let \( Q = \xi(x,t) \).
We can recover \( x(v) \) by choosing a functional \( c \) which takes its unique maximum in the vertex \( v \) of \( P \).
Then \( x(v) \) is the unique maximiser of \( c \) in \( Q \).
This determines \( (x,t) \) as \( t \) is determined by \( x \).

It remains to show that \( \xi \) is a morphism of abstract cones.
To this end let \( (x,t), (x',t') \in \VertexEdgeCone_P \).
Let \( V \in \Vertices (\xi(x,t) + \xi(x',t')) \) and choose a functional \( c \) which maximises \( V \) uniquely.
The monotonicity lemma tells us that there is a vertex \( v \) in \( P \) maximising \( c \) such that \( V = x(v) + x'(v) \):
Actually, let \( v \in P \) be any vertex maximising \( c \).
Then the lemma says that \( x(v), x'(v) \) still maximise \( c \) (uniquely) in \( \xi(x,t) \) and \( \xi(x',t') \) respectively, so \( V = x(v) + x'(v) \), as claimed.
This leads us to defining \( x''(v) \defeq x(v) + x'(v) \).
Consider an edge \( [v,w] \in \Edges P \):
\[ x''(v) - x''(w) = x(v)+x'(v) - x(w) - x'(w) = (t([v,w]) + t'([v,w]))(v-w) \]
so we define \( t''([v,w]) = t([v,w])+t'([v,w]) \), therefore \( (x'',t'') = (x,t) + (x',t') \) and
\[ \xi(x,t) + \xi(x',t') = \xi(x'',t'') = \xi((x,t)+(x',t')). \]
#+end_proof

*** The vertex deformation cone
#+index: vertex deformation cone
#+index: deformation cone ! vertex def. cone

The /vertex deformation cone/ has been defined in [[cite:postnikov06_faces_gener_permut][Definition 15.1.(1)]]

#+begin_definition
The /vertex deformation cone/ \( \VertexCone_P \) of a polytope \( P \) is the set
#+index: \( \VertexCone \) \see{vertex deformation cone}
\[ \Set{ x \in (\mathbb{R}^n)^{\Vertices P} }{ \forall [v,w] \in \Edges P \exists t \geq 0:\, x(v) - x(w) = t ([v-w]) } \]
#+end_definition

The vertex deformation cone can be written as a projection of \( \VertexEdgeCone_P \) onto its first component:
\[ \VertexCone_P \defeq \Set{ x }{ (x,t) \in \VertexEdgeCone_P } \]

*** Paths on polytopes
To a polytope \( P \) we associate a graph \( \Graph{P} \defeq (\Vertices{P},\Set{ \{v,w\} }{ [v,w] \in \Edges{P}}) \) defines the so-called /graph of the polytope \( P \)/.
#+index: graph of a polytope
#+index: \( \Graph \)

A sequence \( v_0v_1...v_n \) of vertices of \( \Graph{P} \) is a /path/, if \( \{v_i,v_{i-1}\} \) are edges of \( \Graph{P} \) for all \( i \in [n] \).
#+index: path
We say that it has length \( |v_0v_1...v_n| = n \).
#+index: length of a path
Further, if a path \( v_0v_1...v_n \) has identical start and end points \( v_0 = v_n \), then it is a /cyclic path/ of length \( n \).
#+index: cyclic path
Two cyclic paths \( v_0v_1...v_n, w_0w_1...w_n \) are said to differ by a /cyclic permutation/ of their vertices, if \( v_0v_1...v_n = w_iw_{i+1}...w_nw_1...w_i, \) and this defines an equivalence relation.
#+index: cyclic permutation
Two paths \( \pi_1 = v_0v_1...v_n \) and \( \pi_2 = w_0w_1...w_k \) with \( v_n = w_0 \) can be composed \( \pi_1\pi_2 = v_0v_1...v_nw_1...v_k \), which is a path of length \( |\pi_1| + |\pi_2| \).
The /reversed/ path of \( \pi = v_0v_1...v_n \) is \( \pi^{-1} \defeq v_nv_{n-1}...v_0 \) and has the same length.
#+index: reversed path
The reversed path of a cyclic path is again cyclic.
Reversing the composition \( \pi_1\pi_2 \) yields \( (\pi_1\pi_2)^{-1} = \pi_2^{-1}\pi_1^{-1} \).
To extend this notation for cyclic paths \( \pi \) we may set for an integer \( k \)

\[ \pi^k \defeq \begin{cases} 
   \underset{k \text{ times}}{\underbrace{\pi...\pi}},& \text{ if } k > 0
\\ v_0,& \text{ if } k = 0
\\ (\pi^{-1})^{-k}, & \text{ if } k < 0 \end{cases} \]

Every face \( F \) of \( P \) induces a subgraph \( \Graph{F} \) of \( \Graph{P} \).
If \( F \) is 2-dimensional, then the vertices of \( \Graph{F} \) all have degree 2, hence \( \Graph{F} \) is a cyclic graph.
The paths considered in the proof of Lemma \ref{lem:monotonicity} can be quite useful, so we give them a name

#+begin_definition
Let \( P \subset \mathbb{R}^n \) be a polytope and \( c \in \mathbb{R}^{n*} \) be a functional.
A path \( v_0v_1...v_n \) satisfying \( v_0 = v' \), \( v_n = v \) and \( c(v_i - v_{i-1}) > 0 \) for all \( i \in [n] \)
is called a /\( c \)-ascending path/.
#+index: ascending path
#+end_definition

#+begin_corollary
\label{cor:path-connected}
The graph of a polytope \( P \) is /path-connected/, i.e. every two vertices in \( P \) are connected by a path.
#+index: path-connectedness
#+end_corollary
#+begin_proof
Let \( v,w \in P \) be vertices, then choose a functional \( c \) maximising \( w \) uniquely.
Any \( c \)-ascending path of maximal length starting in \( v \) ends in \( w \).
#+end_proof

*** The edge deformation cone
#+index: edge deformation cone
#+index: deformation cone ! edge def. cone
The easiest type of deformation is the translation \( P + x \) of the polytope \( P \) by a vector \( x \).
It therefore makes sense to factor out translations when searching for other types of deformations.
The edge (length) deformation cone, which does exactly this, has been defined in [[cite:postnikov06_faces_gener_permut][Definition 15.1.(1)]] and [[cite:altmann1997versal][Section 2]].

#+begin_definition
Let \( P \) be a polytope.
The /edge (length) deformation cone/ \( \EdgeCone_P \) of \( P \) is the set of all \( t \in \mathbb{R}_+^{\Edges P} \) satisfying
#+index: \( \EdgeCone \) \see{edge deformation cone}

\[ \sum_{i=1}^k t([v_i,v_{i-1}])(v_i-v_{i-1}) = 0 \]

for each 2-dimensional face of \( P \) with \( \Edges P = \left\{ [v_0,v_1],[v_1,v_2],...,[v_{k-1},v_k] \right\} \) with \( v_k = v_0 \).
#+end_definition

It is not entirely obvious, but we will show that \( \EdgeCone_P \) is just the projection of \( \VertexEdgeCone_P \) onto its second component:
\[ \EdgeCone_P = \Set{ t }{ (x,t) \in \VertexEdgeCone_P } \]
In order to do so we introduce Altmann's construction.

*** Altmann's construction
\label{sec:altmann-construction}
#+index: Altmann's construction

In this section we describe the construction given in [[cite:altmann1997versal][Section 2]] to recover a deformation of a polytope \( P \subset \mathbb{R}^n \) from an element \( t \) of the edge deformation cone \( \EdgeCone_P \).
For this we consider the pointed polytope \( (P,v_0) \) instead of only \( P \), where the /distinguished vertex/ \( v_0 \) is any vertex of \( P \).
#+index: distinguished vertex
For each vertex \( v \in \Vertices{P} \) choose a path \( \pi \) in \( \Graph P \) from \( v_0 \) to \( v \).
Then define \( v^{(w,t)} = w + \sum_{i=1}^{|\pi|} t([\pi_i,\pi_{i-1}])(\pi_i - \pi_{i-1}) \) whenever \( w \in \mathbb{R}^n \).
Finally we obtain

\begin{equation}
(P,v_0)^{(w,t)} \defeq \ConvexHull\Set{ v^{(w,t)} }{ v\in \Vertices{P} }. \label{eq:recover-deformation-from-edge-cone}
\end{equation}
#+index: \( (P,v_0)^{\bullet} \) \see{Altmann's construction}

The presented method to recover a polytope is almost the same as in [cite:altmann1997versal] except that \( v_0^t = w \) holds[fn::This will become obvious after we establish path independence in Section \ref{sec:path-independence}], whereas \( v_0^t = v_0 \) in the original formulation.
This choice has been made in order to make the map \( (w,t) \mapsto (P,v_0)^{(w,t)} \) an isomorphism of abstract cones \( \mathbb{R}^n \times \EdgeCone_P \to \DefCone_P \), which we will prove later.
However, before we get ahead of yourselves it is important to note that it is not clear whether \( (P,v_0)^{(v,t)} \) depends on our choice of paths \( \pi \).
This will be investigated in the next sections.

*** Path integration on graphs
We will define a notion of integration on a graph \( G= (V,E) \).

#+begin_definition
Let \( f \in \mathbb{R}^E \) and \( g \in W^V \), where \( W \) is an \( \mathbb{R} \) vector space.
For a path \( \pi \) we define the /path integral/ of \( f \) along \( g\pi \)
#+index: path integral
\[ \inner{ f, g\pi } = \sum_{i=1}^{|\pi|} f([\pi_i, \pi_{i-1}])(g(\pi_i) - g(\pi_{i-1})). \]
If no \( g \) is given and \( V \) is an \( \mathbb{R} \) vector space, we assume \( g = \id_V \).
#+end_definition

Path integration satisfies several laws, which are immediate from the definition:

- If \( \pi_1, \pi_2, \pi_1\pi_2 \) are paths in \( G=(V,E) \), \( W \) a vector space, \( f_1,f_2 \in \mathbb{R}^V \), \( g \in W^V \), then
  \[\inner{ f_1, g(\pi_1 \pi_2)} = \inner{ f_1, g\pi_1 } + \inner{f_1, g\pi_2} \]
  and
  \[\inner{ f_1+f_2, g(\pi_1)} = \inner{ f_1, g\pi_1 } + \inner{f_2, g\pi_1} \]
- If \( c \) is linear, then
  \[ \inner{ f, c\pi } = c\inner{ f, \pi }. \]
- If two cyclic paths \( \pi_1, \pi_2 \) differ only by a cyclic permutation, then
  \[ \inner{ f, g\pi_1 } = \inner{ f, g\pi_2 }, \]
  as summation is invariant under (cyclic) permutations of the summands
- The reversed path of \( \pi \) satisfies
  \[ \inner{ f, g\pi^{-1} } = -\inner{f, g\pi}. \]
- If \( \pi \) is a \( c \)-ascending path of a polytope and \( f \) a non-negative function on \( \Edges P \), then
  \[ \inner{ f, c\pi } \geq 0, \]
  because every term in the sum is non-negative.

*** Path independence
\label{sec:path-independence}

Let \( P \subset \mathbb{R}^n \) be a polytope.
We may rewrite the condition on elements of the edge deformation cone in terms of integrals.
Choosing for each 2-dimensional face \( F \) of \( P \) a cyclic path \( \pi_F \defeq v_0v_1...v_{|\pi_F|} \) which traverses each edge of \( F \) exactly once, we may write

\[ \EdgeCone_P = \Set{ t \in \mathbb{R}_+^{\Edges P} }{ \inner{ t, \pi_F } = 0 \text{ for all 2-dimensional faces } F \text{ of } P }. \]

#+begin_lemma
Let \( F_1 < ... < F_r \) be a shelling of a polytopal complex \( C \) of dimension \( n \geq 1 \).
Then the complex is path-connected.
#+end_lemma

#+begin_proof
If \( C \) is 1-dimensional, then the shelling property implies path-connectedness.
Now assume \( \dim(C) > 1 \) and that we have proven the lemma up to dimension \( \dim(C)-1 \).
Let \( F_1 < ... < F_r \) a shelling of \( C \).
The graph of a polytope is path-connected (Corollary \ref{cor:path-connected}), so \( \bigcup_{i=1}^1 F_i \) is path-connected.
Now assume that the complex \( \bigcup_{i=1}^l F_i \) is path-connected.
The intersection \( F_{l+1} \cap \bigcup_{i=1}^l F_i \) is, by shelling property, itself a shelling of dimension \( \dim(C)-1 \).
It is thus by induction hypothesis path-connected.
Let \( u \in F_{l+1} \cap \bigcup_{i=1}^l F_i \).
Thus any two vertices \( v, w \in \bigcup_{i=1}^{l+1} F_i \) can be connected by a path as follows:
Let \( \pi_1 \) be a path from \( v \) to \( u \) and let \( \pi_2 \) be a path from \( u \) to \( w \).
Note that \( v,u \in F_{l+1} \) or \( v,u \in \bigcup_{i=1}^l F_i \), so due to connectedness the path \( \pi_1 \) exists in either case.
The same argument holds for \( \pi_2 \).
The desired path connecting \(v\) and \(w\) is \( \pi_1\pi_2 \).
We've proven by induction that \( C = \bigcup_{i=1}^r F_i \) is path-connected.
#+end_proof

#+begin_theorem
\label{thm:contractibility}
Let \( P \) be a polytope and \( t \in \EdgeCone_P \), then \( \inner{ t, \pi } = 0 \) holds for all cyclic paths \( \pi \) in \( P \).
#+end_theorem

#+begin_proof
If the length of \( \pi \) is 0, any integral vanishes, so we can assume \( |\pi| > 0 \).

- case \( \dim P  = 0 \) ::
     Any path has length 0.
- case \( \dim P = 1 \) ::
     \( P = [v,w] \) and any cyclic path is, without loss, of the form \( (vw)^k \) for some positive integer \( k \).
     If the latter is the case, then \( \inner{t, \pi} = k \inner{t, vwv} = k ( t(vw)(w-v) + t(vw)(v-w)) = 0 \).
- case dim(P) = 2 ::
     The graph of \( P \) is cyclic.
     Let \( \gamma \) be a cyclic path which traverses each edge once.
     As seen in the case of \( \dim P = 1 \) we can assume without loss that there exists no \( i \) such that \( \pi_i = \pi_{i+2} \), as we can remove such a segment without changing the integral.

     This however implies that \( \pi = \gamma^n \) or \( \pi = (\gamma^{-1})^{n} \) for some \( n \geq 1 \).
     In the former case, \( \inner{t, \pi} = n \inner{t, \gamma} = 0 \) by the defining property of \( \EdgeCone_P \).
     In the latter case, \( \inner{t, \pi} = n \inner{t, \gamma^{-1}} = -n \inner{t,\gamma} = 0 \).
- case dim(P) > 2 ::
     Assume the theorem holds for all polytopes up to dimension \( \dim(P)-1 \).
     The graph \( \Graph P \) is also the graph of polytopal complex \( \partial P \) of dimension \( \dim(P)-1 \).
     It is known that the boundary complex \( \partial P \) is shellable [[cite:bruggesser72_shellable][Corollary 4]], hence it suffices to show the

     #+begin_quote
     *Claim*: Let \( C \) be a shellable polytopal complex of dimension \( \dim(P)-1 \) with graph \( G \), \( t \) a function on the edges of \( G \) such that for every 2-dimensional polytope \( F \) in \( C \) the equality \( \inner{ t, \pi_F } = 0\) holds.
     Then \( \inner{ t, \pi } = 0 \) for every cyclic path \( \pi \) in \( G \).
     #+end_quote

     We proceed by induction on the size \( r \) of the shelling \( F_1 < ... < F_r \) of \( C \).
     If \( r=1 \) we're done, as \( \pi \) lives in \( F_1 \) with \( \dim(F_1) < \dim(P) \).
     Now assume \( r > 0 \).
     If \( \pi \subset F_r \) or if \( \pi \subset \bigcup_{i=1}^{r-1} F_i \) we're done due to our two induction hypotheses.
     So we can assume that \( \pi \cap F_r \neq \emptyset \) and \( \pi \cap \bigcup_{i=1}^{r-1} F_i \neq \emptyset \).
     We know that \( F_r \cap \bigcup_{i=1}^{r-1} F_i \) is a shellable polytopal complex of dimension \( \dim(P)-2 \geq 1 \) and hence is path-connected by the previous lemma.
     Whenever \( \pi \) meets \( F_r \setminus \bigcup_{i=1}^{r-1} F_i \) in a vertex \( v \) we can find an decomposition \( \pi = \pi_1\pi_2\pi_3 \), such that \( v \in \pi_2 \) and the path \( \pi_2 \) starts and ends in \( F_r \cap \bigcup_{i=1}^{r-1} F_i \).
     By path-connectedness of \( F_r \cap \bigcup_{i=1}^{r-1} F_i \) we can choose a path \( \pi'_2 \) in that intersection with the same start and end point as \( \pi_2 \).
     Define \( \pi' = \pi_1\pi'_2\pi_3 \).
     Path independence in \( F_r \) then yields \( \inner{t, \pi} = \inner{t, \pi'} \).
     So it suffices to show the second integral to vanish, and you can see that by successive removal of vertices outside of \( \bigcup_{i=1}^{r-1} F_i \) we obtain a cyclic path \( \pi^* \) which lives completely in \( \bigcup_{i=1}^{r-1} F_i \).
     The induction hypothesis applies again and we see that
     \[ \inner{t, \pi} = \inner{t,\pi^*} = 0. \]
#+end_proof

#+begin_corollary
[Path independence]
\label{cor:path-independence}
Under the conditions of the theorem, if \( \pi_1, \pi_2 \) are paths in \( \Graph P \) both starting in a common vertex and ending in a common vertex, then \( \inner{ t, \pi_1 } = \inner{ t, \pi_2 } \).
#+end_corollary

#+begin_proof
The path \( \pi_1\pi_2^{-1} \) is cyclic, so
\[ 0 = \inner{ t, \pi_1\pi_2^{-1} } = \inner{ t, \pi_1} - \inner{t,\pi_2}. \]
#+end_proof
*** Equivalence of the deformation cones

We continue with the notation of section \ref{sec:altmann-construction}.
With Corollary \ref{cor:path-independence}, we have at last justified that the path integrals \( \inner{t,\pi} \) only depend on the start and end point of \( \pi \), so the following definition now makes sense.

#+begin_definition
Let \( P \subset \mathbb{R}^n \) be a polytope with distinguished vertex \( v_0 \) and let \( (w,t) \in \mathbb{R}^n \times \EdgeCone_P \).

For each \( v \in \Vertices P \) and any path \( \pi \) from \( v_0 \) to \( v \) we obtain the linear map

\[ v^\bullet : \mathbb{R}^n \times \mathbb{R}^{\Edges{P}} \to \mathbb{R}^n, (w,t) \mapsto v^{(w,t)} \defeq w + \inner{ t, \pi }, \]

With this we can define the /deformation of \( (P,v_0) \) by \( (w,t) \)/,
\[ (P,v_0)^{(w,t)} \defeq \ConvexHull\Set{ v^{(w,t)} }{ v\in \Vertices{P} }. \]
#+end_definition

#+begin_proposition
\label{prop:edge-cone-is-vertex-edge-cone}

Let \( P \subset \mathbb{R}^n \) be a polytope.
The function
\begin{alignat*}{2}
\zeta :& \mathbb{R}^n \times \EdgeCone_P &\to    & \VertexEdgeCone_P
     \\& (w,t)                           &\mapsto& \zeta(w,t)
\end{alignat*}
where \( \zeta(w,t) = (x,t)  \) is the unique solution of
\begin{align*}
  x(v) - x(v') - t([v,v'])(v-v') =& 0 \quad \text{ for all }  [v,v'] \in \Edges P \\
  x(v_0) = w             \geq& 0
\end{align*}
is an isomorphism of cones.
#+index: \( \zeta \)
#+end_proposition

#+begin_proof
We check existence and uniqueness of \( \zeta(w,t) \) first.
Let \( x(v) \defeq v^{(w,t)} \) for all \( v \in \Vertices P \) and consider an edge \( [v,v'] \).
If we choose a path \( \pi \) from \( v_0 \) to \( v' \) we see that \( \pi v \) is a path from \( v_0 \to v \) and \( x(v) - x(v') = v^{(w,t)} - v'^{(w,t)} = \inner{t, \pi v} - \inner{t, \pi} = t([v,v'])(v-v') \).
Of course, \( x(v_0) = v_0^{(w,t)} = w \).
Because \( x(v) = t([v,v'])(v-v') + x(v') \) holds, the value of \( x(v) \) is determined by its neighbours, which allows us do prove uniqueness by induction on the distance between \( v_0 \) and \( v \), starting with \( x(v_0) = w \).

The left-inverse of \( \zeta \) is easily seen to be \( \zeta^{-1}(x,t) = (x(v_0),t) \).
That it is also the right-inverse follows by the uniqueness argument.
#+end_proof

#+begin_corollary
\label{cor:edge-cone-is-def-cone}

The map \( (w,t) \mapsto (P,v_0)^{(w,t)} \) is an isomorphism of abstract cones \( (P,v_0)^\bullet : \mathbb{R}^n \times \EdgeCone_P \to \DefCone_P \)
#+index: \( (P,v_0)^{\bullet} \) \see{Altmann's construction}
#+end_corollary

#+begin_proof
Use the isomorphism \( \xi \) from Corollary \ref{cor:xi-isomorphism} and write \( (P,v_0)^\bullet = \xi\zeta \).
#+end_proof

#+begin_corollary
\( \EdgeCone_P \) is the projection of \( \VertexEdgeCone_P \) onto its second component,
\[ \EdgeCone_P = \Set{ t }{ (x,t) \in \VertexEdgeCone_P } \]
#+end_corollary

#+begin_corollary
\( \dim(\DefCone_P) = \dim(\VertexEdgeCone_P) = n + \dim(\EdgeCone_P) \)
#+end_corollary

** Minkowski Summands
#+index: Minkowski summand

*** Deformations are Minkowski summands
It turns out that the notion of a Minkowski summand and a deformation are equivalent.
Every Minkowski summand of a polytope is a deformation of it and every deformation of a polytope is the Minkowski summand of a dilation of that polytope.
At least one direction should not surprise us at this point.

#+begin_proposition
A deformation \( Q \) of the polytope \( P \) is a Minkowski summand of some dilation \( \lambda P \).
#+end_proposition

#+begin_proof
Let \( v_0 \) be a distinguished vertex of \( P \subset \mathbb{R}^n \).
By Corollary \ref{cor:edge-cone-is-def-cone} we can write \( Q = (P,v_0)^{(w,t)} \) for some \( (w,t) \in \mathbb{R}^n\times\EdgeCone_P \).
Consider now \( s(e) \defeq \lambda \defeq \max \Set{t(e')}{ e' \in \Edges P} \) for all \( e \in \Edges P \).
The element \( s \in \EdgeCone_P \) describes a central dilation of \( P \) modulo translation and has the property that \( s - t \geq 0 \), so \( s-t \in \EdgeCone_P \) as well.
Thus \( \lambda P = (P,v_0)^{(\lambda v_0,s)} = Q + (P,v_0)^{(\lambda v_0-w,s-t)}  \) which establishes \( Q \) as Minkowski summand.
#+end_proof

:NOTES:
- Überleitung zur converse direction???
:END:

*** The normal fan of a polytope

In this section we study the relationship between Minkowski sums and normal fans
For basic facts about fans and normal fans we refer to [[cite:ziegler95_lectur_polyt][section 7.1]] -- we will cite the pertinent definitions and results once the need arises.
A /fan \( \Sigma \)/ in a vector space \( E \) is a finite collection of cones in \( E \), such that each face of a cone in \( \Sigma \) is again contained \( \Sigma \) and each intersection of two cones in \( \Sigma \) is a face of both.
#+index: fan
The fan \( \Sigma \) is called /complete/ if the union of its cones covers all of \( E \).
#+index: fan ! complete
To a polytope we may assign a complete fan as follows.

#+begin_definition
Let \( P \subset \mathbb{R}^n \) be a polytope.
Its /normal fan \( \NormalFan P \)/ is defined as the finite collection of cones
#+index: normal fan
\[ \NormalCone(F,P) \defeq \Set{ u \in \mathbb{R}^{n*} }{ \Face(P,u) = F } \]
for each non-empty face \( F \) of \( P \).
The cone \( \NormalCone(F,P) \) is called the /normal cone/ at \( F \).
#+index: normal cone
#+end_definition

Note that \( F \mapsto \NormalCone(F,P) \) determines an order-reversing isomorphism of the face lattice of \( P \) to \( (\NormalFan P \cup \{ \mathbb{R}^n \}, \subseteq) \) setting \( \NormalCone(\emptyset,P) \defeq \mathbb{R}^n \).
Normal cones of vertices are those of codimension 0, whereas normal cones of edges are those of codimension 1, etc.
We say that a fan \( \Sigma \) /refines/ another fan \( \Sigma' \) if each cone \( \sigma \in \Sigma \) is contained in a cone \( \sigma' \in \Sigma' \).
#+index: fan ! refinement
Alternatively we may say that \( \Sigma' \) /coarsens/ \( \Sigma \).
#+index: fan ! coarsening
[[cite:ziegler95_lectur_polyt][Proposition 7.12]] states that the normal fan of a Minkowski sum \( Q+Q' \) a refinement of both normal fans of \( Q \) and \( Q' \).

#+begin_remark
The other direction, as demonstrated in [[cite:postnikov06_faces_gener_permut][Theorem 15.3]], is true as well.
That is, if \( \NormalFan P \) refines \( \NormalFan Q \), then \( Q \) is a Minkowski summand of a dilation of \( P \).
We will show in the next section (Proposition \ref{prop:minkowski-summand-is-deformation}) that Minkowski summands are deformations, yielding
\[ \DefCone_P = \Set{ Q \in \Polytopes(\mathbb{R}^n) }{ \NormalFan Q \text{ coarsens } \NormalFan P }, \]
which also shows that a deformation \( Q' \) of a deformation \( Q \) of \( P \) is again a deformation of \( P \).
#+end_remark
:NOTES:
- promise is promise, prove it when we're ready to do so
- will we give the same proof though?
- the normal fan view shows that deformations of interior points of a deformation cone give the same cone
:END:

*** Minkowski summands are deformations

#+begin_proposition
\label{prop:minkowski-summand-is-deformation}
Let \( P = Q + Q' \) be a Minkowski sum of polytopes in \( \mathbb{R}^n \).
Then \( Q \) is a deformation of \( P \).
#+end_proposition

#+begin_proof
By [[cite:ziegler95_lectur_polyt][Proposition 7.12]] we know that \( \NormalFan P \) refines \( \NormalFan Q \).
In fact we can define the map \( \Phi \) assigning to \( \sigma \in \NormalFan P \) the least cone \( \Phi(\sigma) \in \NormalFan Q \) containing \( \sigma \), which is just \( \Phi(\sigma) \defeq \bigcap \Set{\sigma'}{\sigma' \supseteq \sigma} \).
This yields a map \( \phi : \FaceLattice P \to \FaceLattice Q \) between the face lattices sending \( \emptyset \) to \( \emptyset \) and a face \( F \subseteq P \) to \( F' \subseteq Q \) in correspondence to \( \Phi(\NormalFan(F,P)) = \NormalFan(F',Q) \).
It can be easily verified that \( \phi \) is a homomorphism of lattices, in particular \( \phi F \subseteq \phi F' \) whenever \( F \subseteq F' \).

Clearly, codimension 0 cones are sent to codimension 0 cones, so \( \phi \) maps vertices to vertices -- even surjectively so as the normal cone of \( P \) is complete.
Also, codimension 1 cones are sent to either codimension 1 or codimension 0 cones, so \( \phi \) maps edges to edges or vertices.
This aligns with the intuition that edges can be contracted to vertices.
Note that if \( \sigma \subseteq \sigma' \) are codimension 1 cones in \( \mathbb{R}^{n*} \), then they determine the same edge direction:

 \[ L \defeq \ker\sigma = \ker\sigma' \defeq \Set{ x \in \mathbb{R}^n }{ \forall c \in \sigma':\, cx = 0 }, \quad \dim L = 1 \]

Now let \( [v,w] \) be an edge of \( P \), then \( \phi[v,w] = [\phi v, \phi w] \) is either a vertex, so \( \phi v - \phi w = 0(v-w) \), or it is an edge, in which case
\( \phi v - \phi w = \lambda (v-w) \).
To see that \( \lambda \geq 0 \), choose \( c \in \NormalCone(v,P) \setminus \NormalCone(w,P) \subset \NormalCone(\phi v, Q) \).
This satisfies \( cv > cw \) and \( c(\phi v) \geq c(\phi w) \), so \( 0 \leq c(\phi v - \phi w) = \lambda c(v-w) \).
As \( c(v-w) > 0 \) this implies \(  \lambda \geq 0 \), which shows that \( Q \) is indeed a deformation of \( P \).
#+end_proof

#+begin_corollary
\label{cor:deformations-via-normal-fan}
We can write the deformation cone of a polytope \( P \subset \mathbb{R}^n \) as
\[ \DefCone_P = \Set{ Q \in \Polytopes(\mathbb{R}^n) }{ \exists \lambda\geq 0, Q' \in \Polytopes(\mathbb{R}^n):\, \lambda P = Q+Q' } \]
#+end_corollary

** Examples
*** Simplex
\label{sec:example-simplex}

We define the simplex \( \Delta_{[n]} \) as convex hull of standard unit vectors \( e_i, i \in [n] \).
It has dimension \( n-1 \) and its faces are \( \Delta_I \defeq \ConvexHull\Set{e_i}{ i \in I} \) for \( \emptyset \neq I \subseteq [n] \).
The dimension is \( \dim\Delta_I = \#I-1 \).

We give an equivalent description via linear inequalities:
#+begin_proposition
Let \( \emptyset \neq I \subseteq [n] \).
Then

\[ \Delta_I = \Set{ x \in \mathbb{R}^n }{ \sum_{i\in [n]} x_i = 1, \sum_{i\in J} x_i \geq \OneOrZero{I\subseteq J}, \emptyset \neq J \subseteq [n] } \]
#+end_proposition
#+begin_proof

For a non-empty \( J \subseteq [n] \) we have \( \min\Set{ \sum_{j\in J} x_j }{ x \in \Delta_I } = \min\Set{ \sum_{j \in J} (e_i)_j }{ i \in I } = \OneOrZero{I \subseteq J} \), so the inequalities hold tightly for every point in \( \Delta_I \).
Now take a point \( x \) satisfying all inequalities, in particular \( \sum_{i\in [n]} x_i = 1 \), \( \sum_{i\in I} x_I \geq 1 \) and \( x_i \geq 0 \) for all \( i \).
Then it remains to show that \( x_j = 0 \) whenever \( j \in J = [n] \setminus I \):
\[ 0 \leq x_j \leq \sum_{j\in J} x_j = 1 - \sum_{i\in I} x_i \leq 1 -1 = 0 \]
#+end_proof

Now take an element \( t : \Edges(\Delta_I) \mapsto \mathbb{R}_+ \) of the edge length deformation cone.
This element fulfils the condition that the line segments \( t([e_1,e_i])(e_1 - e_i), t([e_i,e_j])(e_i-e_j), t([e_j,e_1])(e_j-e_1) \) form a triangle.
But because the edge-directions don't change after deformation, the angles between the sides must remain the same, and thus the side lengths are scaled uniformly[fn::Alternatively, just compute the kernel of the \(n\times 3\) matrix \( (e_i-e_1|e_j-e_i|e_1-e_j) \) of rank \( 2 \).].
In particular we have for all edges \( [ e_i, e_j ] \):
\[ t([e_1,e_i]) = t([e_1,e_j]) = t([e_i,e_j])\]
The edge length deformation cone therefore consists of a single ray, so \( \dim(\DefCone_{\Delta_I}) = n + \dim(\EdgeCone_{\Delta_I}) =  n + 1 \).

Simplices are examples of rigid polytopes.
#+index: rigidity

#+begin_definition
A polytope \( P \) is called /rigid/ if \( \dim \EdgeCone = 1 \), i.e. the only deformations are translations of dilations of \( P \).
#+end_definition
*** Pyramids                                                          :draft:
:NOTES:
- Take \( P \in \mathbb{R}^n \) polytope and embed into \( x_{n+1} = 1 \) plane of \( \mathbb{R}^{n+1} \).
  Now define \( Q = \conv(P, 0) \). \( Q \) is indecomposable, i.e. \( \dim(\EdgeCone_Q) = 1 \).
- The truncated pyramid \( P=\conv(0,[-1,1]^2\times\{1\}) \) can be "blown up" to be \( Q=conv([-1,1]^2\times\{0\}, [-2,2]^2\times\{1\}) \), which is simplicial.
  \( Q = P + [-1,1]\times\{0\} \). \( \EdgeCone_Q \) has 3 rays, one being \( P \) and the other two being the segments \( [0,e_1], [0,e2] \) (which are unsurprising given the Minkowski sum decomposition).
  We can describe the combinatorial type of all faces of the edge length deformation cone.
:END:
*** Polygons                                                          :draft:
** Moving Facets
*** DONE Introduction
    CLOSED: [2017-06-29 Do 05:08]
In this section we investigate the observation that Minkowski summands of \( P = \Set{ x }{ Ax \leq b } \) seem to always have a description of the form \( P(b') \defeq \Set{ x }{ Ax \leq b' } \) for an appropriate right-hand side \( b' \).
It turns out that all summands parametrised by the deformation cone can be described via appropriate right-hand side vectors \( b' \) lying in a cone \( \FacetCone_{A,b} \) of right-hand sides.
In order to show this we will study the edge deformation cone \( \EdgeCone_P \) and how exactly elements \( t \in \EdgeCone_P \) give rise to coarsenings of the normal fan of \( P \).

*** DONE t-Coarsening
    CLOSED: [2017-06-29 Do 05:07]

Let \( P \) be a polytope with H-representation

\begin{equation*}
\Set{ x }{ Ax \leq b } = \Set{ x \in \mathbb{R}^n }{ a_ix \leq b_i \ForAll i \in [m] } \]
\end{equation*}

for a matrix \( A \) with rows \( a_i \in \mathbb{R}^{n*} \) and \( b \in \mathbb{R}^m \).
Each vertex \( v \in  P \) is an intersection of facets

\begin{equation*}
\{v\} = \bigcap \Set{ \Face(P,a_i)}{ i \in I_v \subset [m] }
\end{equation*}

and the normal cone \( \NormalCone(v,P) \) is the positive hull of \( \Set{ a_i }{ i\in I_v} \).

For \( t \in \EdgeCone_P \) write \( P^t \) for any deformation of the form[fn:: This was defined in equation \eqref{eq:recover-deformation-from-edge-cone} of section \ref{sec:altmann-construction}] \( (P,v_0)^{(w,t)} \).
The choice of \( P^t \) is unique up to translation and thus the normal fan of \( P^t \) depends solely on \( t \), so we write \( \Sigma_t \defeq \NormalFan(P^t) \).
We call \( \Sigma_t \) the /\( t \)-coarsening/ of the normal fan of \( P \).
#+index: t-coarsening
A maximal cone in \( \Sigma_t \) is the union of maximal cones in \( \NormalFan(P) \).
Determining the maximal cones of \( \Sigma_t \) amounts therefore to computing an equivalence relation \( \sim \) on \( \Vertices P \):

\begin{equation}
\NormalCone(\phi v, P^t) = \bigcup_{w\sim v} \NormalCone(w,P) \quad \text{ for all } v \in \Vertices P \label{eq:union-of-normal-cones}
\end{equation}

In order to do so explicitly, recall the definition \( \phi : \FaceLattice P \to \FaceLattice P^t \) from the proof of Proposition \ref{prop:minkowski-summand-is-deformation}.
By definition, \( \NormalCone(v,P) \subseteq \NormalCone(w,P^t) \) if and only if \( \phi(v) = w \), hence we must set

\[ v \sim w \defequiv \phi(v) = \phi(w), \quad \ForAll v,w \in \Vertices P. \]


#+begin_corollary
\label{cor:t-coarsening}
The cones in the \( t \)-coarsening of \( \NormalFan(P) \) are generated by the \( a_i \).
In particular \( P^t = P(b') \) for some \( b' \in \mathbb{R}^m \).
#+end_corollary

#+begin_proof
From equation \eqref{eq:union-of-normal-cones} it follows for each vertex \( w \in P^t \) that
\[ \NormalCone(w,P^t) = \ConeHull\Set{ a_i }{ i \in I_v \ForAll v \in \Vertices(P) \With \phi(v) = w } \]
This shows the claim for maximal cones of \( \Sigma_t \).
In general a fan is specified by giving its maximal cones and the remaining cones are just faces of these maximal ones.
As such, they are positive hulls of a subset of the \( a_i \) as well.
#+end_proof

*** DONE The facet deformation cone
    CLOSED: [2017-06-29 Do 05:51]
The naive approach to defining the facet deformation cone would be to let it consist of the of right-hand sides \( b' \) which yield deformations.
The reason this is not ideal is that even if \( b',b'' \) are deformations \( P(b'), P(b'') \) of \( P \), their sum \( P(b') + P(b'') \) may not be \( P(b'+b'') \), so we lose the cone property.
Fortunately there is a remedy: We must require the inequalities with right-hand sides \( b',b'' \) to be sharp.

#+begin_definition
Let \( P \) be a polytope with H-representation \( \Set{ x \in \mathbb{R}^n }{ \forall i \in [m]:\, a_ix \leq b_i } \).
The right-hand side \( b \in \mathbb{R}^m \) is called /tight/ if for each \( i \in [m] \) we have \( \Set{ x }{ a_i x = b_i } \cap P \neq \emptyset \) or in other words
#+index: tightness
\[ b_i = \max_{x\in P} a_i x. \]
#+end_definition

#+begin_beispiel
Consider
\begin{align*}
P' \defeq& [0,1]^2 \cap \Set{ (x,y) }{x+y\leq 3 } \text{ and } \\
P'' \defeq& [0,1]^2 \cap \Set{ (x,y) }{x+y\leq 1 }, \text{ but } \\
P'+P'' \neq\,& ([0,1]^2 + [0,1]^2) \cap \Set{ (x,y) }{ x+y \leq 4 }.
\end{align*}
The right-hand side of the inequality \( x+y\leq 3 \) is not tight.
#+end_beispiel

#+begin_definition
Let \( P \) be a polytope with H-representation \( \Set{ x }{ Ax \leq b } \).
For a right-hand side \( b' \) we write \( P(b') \defeq \Set{ x }{ Ax \leq b' } \).
The /facet deformation cone/ of \( P \) is the set

\[ \FacetCone_{A,b} \defeq \Set{ b' }{ P(b') \in \DefCone_P \text{ and } b' \text{ is tight}} \]
#+index: facet deformation cone
If it is clear from the context which system of inequalities is used or if the particular H-description does not matter, we may write \( \FacetCone_P \) instead.
#+index: deformation cone ! facet def. cone
If we have a H-representation with equalities
\[ P(A,b;C,d) \defeq \Set{ x }{ Ax \leq b, Cx = d }, \]
then we may write
\[  \FacetCone_{C,d;A,b} \defeq \Set{ (d,b) }{ P(A,b;C,d) \in \DefCone_P \text{ and } b \text{ is tight} } \]
#+end_definition

The cone \( \FacetCone_{C,d;A,b} \) is isomorphic to \( \FacetCone_{A',b'} \) with
\[ A' \defeq \begin{pmatrix} C \\ -C \\ A \end{pmatrix} \quad \text{ and } \quad b' \defeq \begin{pmatrix} d \\ -d \\ b \end{pmatrix} \]


#+begin_remark
The facet deformation cone has been defined similarly in [[cite:postnikov06_faces_gener_permut][Definition 15.1.(3)]].
There is a difference in that we allow non-facet-defining inequalities and polytopes which are not full-dimensional.
#+end_remark

#+begin_theorem
\label{thm:facet-cone-isomorphism}
\( \FacetCone_{A,b} \) is a cone and isomorphic to \( \VertexEdgeCone_P \).
#+end_theorem

#+begin_proof
For each row \( a_i \) of \( A \) choose a vertex \( v_i \in \Face(P,a_i) \).
Let \( (x,t) \in \VertexEdgeCone_P \).
We define \( b(x,t)_i \defeq a_i x(v_i) \).
The precise choice of \( v_i \) was irrelevant, because Lemma \ref{lem:monotonicity} tells us that for vertices \( w \) with \( a_i(v_i) = a_i(w) \) we also have \( a_i(x(v_i)) = a_i(x(w)) \).
The same lemma also tells us that \( a_i(x(v_i)) \geq a_i(x(w)) \) for all \( w \in \Vertices P \).
Recall the isomorphism \( \xi : \VertexEdgeCone_P \to \DefCone_P \), and note that the inequality implies \( \xi(x,t) \subseteq P(b(x,t)) \).
Because the polytope \( \xi(x,t) \) is a deformation of \( P \), Corollary \ref{cor:t-coarsening} tells us that \( \xi(x,t) \)  admits an H-representation involving the \( a_i \).
The right-hand side \( b(x,t) \) is tight by construction and therefore \( \xi(x,t) = P(b(x,t)) \).
Note that \( b(x,t)_i \) is linear in \( (x,t) \), so we obtain a morphism of (abstract) cones

\begin{alignat*}{2}
B :& \VertexEdgeCone_P &\to    & \FacetCone_{A,b}
\\ & (x,t)             &\mapsto& b(x,t)
\end{alignat*}

The inverse is given by \( b' \mapsto \xi^{-1}P(b') \).
#+end_proof

#+begin_remark
The image of singleton sets \( \{ x \} \in \DefCone_P \) under \( B\xi^{-1} \) is the column space of \( A \).
#+end_remark
*** TODO Deformations of simple polytopes
**** TODO H-representation
 \label{sec:deformations-of-simple-polytopes}
  #+index: deformation cone!H-representation

 :NOTES:
 - for W-permutahedra we may thus reduce ourselves to \( w' \) of even length when symmetrising
   this covers all edges
   - A2: permutahedron has 6 edges, deformation cone has 6 facets
   - A3: permutahedron has 36 edges, deformation cone has 24 facets
   - A4: permutahedron has 240 edges, deformation cone has 80 facets
 :END:

 In this section we will compute the H-representation for the facet deformation cone of a polytope
 
 :EQUATION:
 \begin{equation}
 P = \Set{ x \in \mathbb{R}^n }{
 \begin{aligned}
 a_i(x)    =\,& \tilde{b}_i \quad \ForAll i \in I \\
 a_j(x) \leq\,& \tilde{b}_j \quad \ForAll j \in J
 \end{aligned} }
 \label{eq:deformations-of-simple-polytopes-1}
 \end{equation}
 :END:

 under the following conditions:

 :EQUATION:
 \begin{equation}
 \begin{cases}
 \text{ \( P \) is simple}  \\
 \text{ the inequalities \( a_j(x) \leq \tilde{b}_j \) are facet-defining for } j \in J \\
 \text{ the functionals \( \Set{ a_i }{ i \in I } \) are linearly independent} \\
 \text{ \( I \) and \( J \) are disjoint} \\
 \end{cases}
 \label{eq:deformations-of-simple-polytopes-2}
 \end{equation}
 :END:

 #+begin_lemma
 \begin{equation}
 \dim(P) = n - \Card{I} \label{eq:simple-polytope-dimension}
 \end{equation}
 #+end_lemma

 #+begin_proof
 Because the rows vectors \( \Set{ a_i }{ i\in I }  \) are linearly independent,
 \[ H \defeq \Set{ x\in\mathbb{R}^n }{ a_i(x) = 0 \forall i \in I } \]
 has dimension \( n - \Card{I} \).
 Restricting to \( H \) we may assume that \( P \) is the intersection of facet-defining half-spaces.
 Therefore \( P \) is full-dimensional in \( H \), and hence \( \dim(P) = \dim(H) = n - \Card{I} \).
 :HIDDEN:
 - Inductive argument: Suppose \( C \) convex polyhedron and \( H \) is hyperplane, \( \dim(C\cap H) \geq \dim(C)-1 \). Then \( \dim(C) = \dim(C\cap H^+) \), where \( H^+ \) is a half-space such that \( H\subset H^+ \) and \( C \cap (H^+\setminus H) \neq \emptyset \).
 :END:
 #+end_proof

 #+begin_definition
 For every vertex \( v \in P \) define the /vertex basis set/
 \begin{equation}
 \mathcal{B}_v \defeq \Set{ i \in I\cup J }{ a_i(v) = b_i }. \label{eq:vertex-basis-set}
 \end{equation}
 Further define \( B_v \in \mathbb{R}^{\mathcal{B}_v\times n} \) to be the matrix with rows \( \Set{ a_i }{ i \in \mathcal{B}_v} \).
 We call \( B_v \) the /vertex basis matrix/ of \( v \).
 #+index: vertex basis matrix
 #+end_definition

 #+begin_lemma
 \label{lem:vertex-basis-matrix}
 Let \( v \) be a vertex of \( P \).
 A basis vertex matrix \( B_v \) is invertible and satisfies
 \begin{equation}
 v = B_v^{-1}\cdot \tilde{b}|_{\mathcal{B}_v}
 \end{equation}

 Here \( \tilde{b}|_{\mathcal{B}_v} \) is the restriction of \( b \) to entries indexed by \( B_v \).
 #+end_lemma

 #+begin_proof
 By \eqref{eq:deformations-of-simple-polytopes-2} the rows of \( B_v \) are linearly independent.
 Because \( P \) is simple the number of facets meeting in \( v \) is \( \dim(P) = n - \Card{I} \).
 Therefore

 \[ \Card{B_v} = \Card{I} + (n - \Card{I}) = n \]

 is the number of rows, which immediately implies that the rows form a basis of \( \mathbb{R}^{n*} \).
 The last statement follows from equation \eqref{eq:vertex-basis-set} which implies
 \[ B_v\cdot v = \tilde{b}|_{\mathcal{B}_v}. \]
 #+end_proof

 #+begin_lemma
 \label{lem:card-of-B}
 Let \( [v,w] \subset P \) be an edge, that is, \( v \) and \( w \) are adjacent vertices of \( P \).
 Then

 \begin{align}
                       \Card{\mathcal{B}_v} =&\ n    \label{eq:card-of-B}
 \\ \Card{\mathcal{B}_v \cap \mathcal{B}_w} =&\ n-1  \label{eq:card-of-B-cap}
 \\   \mathcal{B}_v \setminus \mathcal{B}_w =&\ 1    \label{eq:card-of-B-setminus}
 \end{align}
 #+end_lemma

 #+begin_proof
 Equation \eqref{eq:card-of-B} is a consequence of Lemma \ref{lem:vertex-basis-matrix}. 
 The line \( \AffineHull([v,w]) \) equals the intersection 
 \( \bigcap_{i\in B_v\cap B_w} \Set{ x\in\mathbb{R}^n }{ a_i(x) = \tilde{b}_i }. \) 
 Counting dimensions we get 

 \[ 1 = \dim([v,w]) = n - \Card{B_v\cap B_w}, \]

 and hence \( \Card{B_v\cap B_w} = n-1 \).
 The correctness of \eqref{eq:card-of-B-setminus} follows: 
 \[ \Card{\mathcal{B}_v\setminus \mathcal{B}_w} = \Card{\mathcal{B}_v \setminus (\mathcal{B}_v \cap \mathcal{B}_w)} = \Card{\mathcal{B}_v} - \Card{\mathcal{B}_v\cap \mathcal{B}_w} = n - (n-1) = 1  \]
 #+end_proof

 Having set up these preliminary notions we can describe \( \FacetCone_P \subseteq \mathbb{R}^{I\cup J} \) via linear inequality constraints.

 #+begin_theorem
 Let \( P \) be a polytope of the form given in equation \eqref{eq:deformations-of-simple-polytopes-1} and satisfying equation \eqref{eq:deformations-of-simple-polytopes-2}.
 For \( b \in \mathbb{R}^{I\cup J} \) define

 \[ P(b) \defeq \Set{ x \in \mathbb{R}^n }{ a_i x = b_i, a_j x \leq b_j, i\in I, j \in J }. \]


 Then the facet deformation cone \( \FacetCone_P \) can be written as

 :EQUATION:
 \begin{equation}
 \Set{ b \in \mathbb{R}^{I\cup J} }{ 
   \begin{aligned}
   b_j \geq a_j(B_w^{-1}\cdot b|_{\mathcal{B}_w})
   &\ForAll [v,w] \in \Edges(P) \\
   &\text{ where }\{j\} = \mathcal{B}_v\setminus \mathcal{B}_w \subset J 
   \end{aligned}}
 \label{eq:cone-inequalities}
 \end{equation}
 :END:
 #+end_theorem

 #+begin_proof
 Let \( b \) be an element of \eqref{eq:cone-inequalities}.
 We will construct the corresponding deformation as a convex hull.
 Define the points of \( \mathbb{R}^n \)
 \[ {v}^{b} \defeq \( B_v^{-1}\cdot b|_{\mathcal{B}_v} \quad\text{ for } v \in \Vertices(P).
 \]
 Their convex hull is a polytope
 \[ C(b) \defeq \ConvexHull\Set{ {v}^{b} }{ v \in \Vertices(P)}. \]

 Let \( [v,w] \subseteq P \) be an edge.
 Equation \eqref{lem:card-of-B-cap} tells us that 
 \( L \defeq \Set{ x\in \mathbb{R}^n}{ a_i(x) = 0 \ForAll i \in B_v \cap B_w } \)
 is a linear subspace of dimension 1.
 \( L \) contains \( v-w \) as well as \( v^{b} - w^{b} \), which means

 \[ {v}^{b} - {w}^{b} = \lambda(v-w) \quad \ForSome \lambda \in \mathbb{R} \]

 By equation \eqref{eq:card-of-B-setminus} there is an index \( j_w \) such that
 \( \{j_w\} = \mathcal{B}_v\setminus \mathcal{B}_w \) and the inequalities
 \begin{align}
 a_{j_w}(v) >&\ a_{j_w}(w)
 \\ a_{j_w}(v^b)
   = a_{j_w}(B_v^{-1}\cdot b|_{\mathcal{B}_v})
   = b_{j_w}
   \geq&\ a_{j_w}(w^{b})  \label{eq:deformation-local-max}
 \end{align}
 hold -- the first due to the definition of \( B_v \) and the second due to \( b \) lying in \eqref{eq:cone-inequalities}.
 This shows that \( \lambda \) is non-negative:

 \[ \lambda = \frac{a_{j_w}(v^{b}-w^{b})}{a_{j_w}(v-w)} \geq 0 \]

 Thus \( C(b) \) is a deformation.
 Because we established in Theorem \ref{thm:facet-cone-isomorphism} that the facet deformation cone is isomorphic to the deformation cone, \( C(b) \) comes with a tight right-hand side \( b' \) such that \( C(b) = P(b') \).

 Looking at equation \eqref{eq:deformation-local-max} we can conclude that the value of \( a_{j_w} \) evaluated at \( v^b \) is no less than the value when evaluated at any neighbour.
 That is, \( v^b \) is a maximiser of \( a_{j_w} \) over \( P(b'') \), hence by tightness of \( b' \)
 \[ b'_{j_w} = a_{j_w}(v^b) = b_{j_w}. \]
 We can easily get this identity for any index \( j \in I\cup J \) by choosing the vertex \( v \in \Face(P,a_j) \) and \( w \) the neighbour of \( v \) which does not lie in \( \Face(P,a_j) \).
 This shows that \( b = b' \), hence \( b \) is tight.
 We have shown that \( P(b) \) is a deformation and \( b \) is a tight right-hand side, thus \( b \in \FacetCone_P \).

 :FIGURE:
 #+caption: Example for a 3-dimensional polytope \( P \) with edge \( [v,w] \) and facet normal \( a_{j_w} \).
 #+name: fig:sign-hasse-diagram
 #+attr_latex: :width 65mm :placement {r}{0.4\textwidth}
 [[./Figures/adjacent-vertex-2.jpg]]
 :END:

 We prove the converse direction:
 Let \( b \in \mathbb{R}^{I\cup J} \) be a tight right-hand side such that \( P(b) \) is a deformation.
 Because the normal fan of \( P(b) \) is a coarsening of the normal fan of \( P \), we can find for each vertex \( v \in P \) a vertex \( x \in P(b) \) for which 
 \( \NormalCone(v,P) \subseteq \NormalCone(x,P(b)) \). 
 Therefore \( B_v \subset \NormalCone(x,P(b)) \) and so \( x \) has the property

 \begin{equation*}
 a_j(x) \geq a_j(y) \quad \ForAll  y \in \Vertices(P(b)) \text{ and } j \in \mathcal{B}_v.
 \end{equation*}
 By tightness of \( b \), \( a_j(x) = b_j \) for all \( j \in \mathcal{B}_v \), so \( x = {v}^{b} \).

 Now if we are given an edge \( [v,w] \), then we can again find a vertex \( y \in P(b) \) such that \( y = w^{b} \).
 For any \( j \in B_v  \) we then get
 \[ b_j = a_j(x) \geq a_j(y) = a_j(w^{b}) = a_j(B^{-1}_w\cdot b|_{B_w}). \]
 This holds in particular for \( j \in B_v \setminus B_w \), as required.
 #+end_proof

 #+begin_remark
 The proof suggests that we actually only need one inequality per edge, so the number of inequalities needed to describe \( \FacetCone_P \) is at most

 \[  \Card{\Edges(P)} = \frac{1}{2}\dim(P)\cdot \Card{\Vertices(P)}. \]

 This gives a simple bound for the number of facets of the deformation cone.
 An easier way to obtain the same bound is to look at the definition of the edge deformation cone.
 #+end_remark

**** Dimension of the deformation cone of a simple polytope   :draft:rewrite:
  :NOTES:
  - simplify proof, maybe vertex-edge length deformation cone can be of use?
  - actually the edge directions are all preserved and the surjective map vert(P) -> vert(P_\eps) is obvious
  - should be able to use "deformations of simple polytopes" to compute this in an easy fashion.
  :END:


   #+begin_lemma
   Let \( P \subset \mathbb{R}^n \) be a simple polytope, \( F = \Face(P,u) \) a facet with \( u(F) = \{ b \} \).
   Then, if \( \eps \) lies in a sufficiently small neighbourhood of \( 0 \), replacing the facet-defining inequality \( u \leq b \) by \( u \leq b+\eps \) gives a deformation of \( P \).
   #+end_lemma

   #+begin_proof
   Our strategy is to construct \( t \in \EdgeCone_P \), such that the modified polytope \( P_\eps \) is a translation of \( P^t \).
   This immediately entails \( P_\eps \in \DefCone_P \).

   Clearly, in order to show \( t \in \EdgeCone_P \), we need a good handle on the 2-dimensional faces of \( P \).
   We have a

   - Trichotomy :: For a 2-dimensional face \( H \subseteq P \) either
     - T1 :: \( H \subset F \)
     - T2 :: \( H \cap F = \emptyset \)
     - T3 :: \( H \cap F \) is a single edge

   We only need to exclude the case that \( H \cap F \) is a single vertex.
   Assuming just this for contradiction we see that two edges of \( H \) not lying in \( F \) meet \( H \cap F \) and at least \( \dim(F) = \dim(P)-1 \) edges in \( F \) meet \( H \cap F \).
   But then more than \( \dim(P) \) edges meet in \( H\cap F \), in contradiction to \( P \) being simple.
   \( \blacksquare \)

   Write \( \Edges P \) as disjoint union \( E_0 \dot\cup E_1 \dot\cup E_2 \) where \( E_0 \) is the set of edges not meeting \( F \), \( E_2 \) is the set of edges in \( F \), and \( E_1 \) is the set of edges having one vertex in \( F \) and one outside of \( F \).

   - Step 1 ::
   For \( e \in E_0 \) set \( t(e) \defeq 1 \).

   - Step 2 ::
   If \( e = [v,w] \in E_1, v \in F \), set \( t(e) = \frac{u(v-w)+\eps}{u(v-w)} \defeq g(e,\eps) \).
   \( g(e,\eps) \) is continuous in \( \eps \), and \( g(e,\eps) > 0 \) for
   \[ e \in R_1(e) \defeq (-u(v-w),\infty). \]
   Note that \( 0 \in R_1(e) \), as \( u(v) > u(w) \).

   - Step 3 ::
   We need to make sure that two edges \( e_1, e_2 \) do not "cross over".
   :FIGURE:
   - [illustration here]
   :END:
   Let \( H \subset P \) be a 2-dimensional face of type T3. Then there are vertices \( v,v',w,w' \in H \), such that \( v,v' \in F; w,w' \notin F \) and \( [w,v], [w',v'] \in E_1, [v,v'] \in E_2 \).
   By our choice of \( t(v,w), t(v',w') \) in (Step 2), we have \( v_\eps \defeq w + t(v,w)(v-w), v'_\eps \defeq w' + t(v',w')(v'-w') \) and \( u(v) = u(v') = b, u(v_\eps) = u(v'_\eps) = b+\eps \).
   Clearly, this suffices to see that there exists a real \( \lambda \) satisfying \( v_\eps - v'_\eps = \lambda(v-v') \), as \( v_\eps, v'_\eps, v, v' \) lie in the 2-dimensional subspace \( \Span(H) \), on parallel lines given by \( u|_{\Span(H)} = b+\eps, u|_{\Span(H)} = b \).

   - Claim 1 ::
     \( \lambda = \lambda(H,\eps) \) is an affine-linear function in \( \eps \) and \( \lambda(H,0) = 1 \).

   From this claim we obtain an open neighbourhood \( R_2(H) \defeq \lambda(H,-)^{-1}((0,\infty)) \) of 0 satisfying \( \eps \in R_2(H) \) if and only if \( \lambda(H,\eps) > 0 \).

   Proof of Claim 1:
   \( v_\eps, v'_\eps \) are affine linear in \( \eps \), so \( Q(\eps, \lambda) \defeq (v-v'|v_\eps - v'_\eps)\begin{pmatrix} \lambda \\ -1 \end{pmatrix} \) is affine linear in \( \eps, \lambda \).
   \( Q^{-1}(0) = \Set{ (\eps, \lambda(H,\eps)) }{ \eps \in \mathbb{R} } \) is an affine linear subspace of \( \mathbb{R}^2 \) and at the same time the graph of \( \lambda(H,-) \), hence \( \lambda(H,-) \) is affine-linear.
   \( \blacksquare \)

   - Claim 2 ::
     Every edge \( e \in E_2 \) occurs as intersection \( F \cap H \) of \( F \) with a T3-type 2-dimensional face \( H \), and this \( H \) is unique.

   Hence we may set \( t(e) \defeq \lambda(H,\eps) \).

   Proof of Claim 2:
   First we show uniqueness.
   Suppose there was a second 2-dimensional face \( H' \) with \( H\cap F = H'\cap F \).
   \( F\cap H = [v,v'] \) and there exist edges \( [w_H,v] \subset H, [w_{H'}, v] \subset H' \).
   Because \( \Span(H') \neq \Span(H) \), also \( w_H \neq w_{H'} \).
   This means there are at least \( \dim(P)+1 \) edges meeting \( v \), in contradiction to \( P \) being simple.

   In order to show the first part of the claim, we'll use the following result from [[cite:ziegler95_lectur_polyt][Proposition 2.4]]:
   Consider the posets \( \Lambda_1 = (\Set{ G \subseteq P \text{ face} }{ v \in G, \dim(G) \geq 1 }, \subseteq) \) and \( \Lambda_2 = (\{ G'\subseteq P/v \text{ face} \},\subseteq) \).
   Then there exists an isomorphism of posets \( \phi : \Lambda_1 \to \Lambda_2 \) such that \( \dim(G) = \dim(\phi(G))+ 1 \) for all \( G \in \Lambda_1 \).

   P being simple means that \( P/v \) is a simplex, and \( \phi(F) \) is a facet of that simplex, hence \( \Vertices P/v \setminus \phi(P) = \{ w \} \), and \( H = \phi^{-1}([w,v]) \) is the required 2-dimensional face.
   \( \blacksquare \)

   So far we have defined (for each \( \eps \in \mathbb{R} \)) the element \( t \) on all of \( E = E_1 \cup E_2 \cup E_3 \).
   Under the condition that \( \eps \in R \defeq \bigcap_{e\in E_1} R_1(e) \cap \bigcap_{H\subseteq P \text{ 2-dim. face}} R_2(H) \), \( R \) being an intersection of finitely many open neighbourhoods of \( 0 \), we'll show that \( t \in \EdgeCone_P \).

   - Claim 3 :: \( t \geq 0 \)
   This is true, as for
   - \( e \in E_0 \): \( t(e) = 1 \)
   - \( e \in E_1 \): \( t(e) > 0 \) as \( \eps \in R_1(e) \)
   - \( e \in E_2 \): \( t(e) > 0 \) as \( \eps \in R_2(H) \) where \( H \) is the 2-dim. face with \( \Vertices(H\cap F) = e \)
   \( \blacksquare \)

   - Claim 4 :: \( \inner{t,\gamma_H} = 0 \) for each cyclic path \( \gamma_H \) on the graph of a 2-dimensional face \( H \subseteq P \)
   This one we'll prove by case analysis.
   - \( H \) is of type T2: \( \inner{t, \gamma_H} = \inner{1,\gamma_H} = 0 \).
   - \( H \) is of type T3: By construction.
   - \( H \) is of type T1:
     Let \( \gamma_H = v_0v_1...v_mv_0 \). For \( i \in [m] \) let \( H_i \) be the 2-dimensional face of type T3 containing \( [v_i,v_{i-1}] \).
     Consider the decomposition \( \gamma_i \defeq \gamma_{H_i} = w_{i-1}v_{i-1}v_{i}w_{i}\eta_i \).
     We already saw that \( \inner{t, \gamma_i} = 0 \).
     The \( v_i \) determine its neighbour \( w_i \) in \( P\setminus F \) uniquely, as \( P \) is simple.
     Note that \( \eta_i \) is a path from \( w_{i+1} \) to \( w_i \) using edges in \( E_1 \).
     Thus \( \eta=\eta_1...\eta_m \) is a cyclic path, and \( \inner{t, \eta} = \inner{1,\eta} = 0 \).
     One can check that \( \sum_{i=1}^m \inner{t, v_{i-1}v_i} = \sum_{i=1}^m -\inner{t,v_{i-1}w_{i-1}} + \inner{t,v_{i-1}v_i} + \inner{t,v_iw_i} = \sum_{i=1}^m \inner{t, w_{i-1}v_{i-1}v_iw_i} \).
     Therefore
     \[ \inner{t,\gamma_H} = \sum_{i=1}^m \inner{t, v_{i-1}v_i} = \sum_{i=1}^m \inner{t, w_{i-1}v_{i-1}v_iw_i} = \sum_{i=1}^m \inner{t,\gamma_i} - \inner{t,\eta} = 0. \]
   \( \blacksquare \)
  
   It remains to check that \( P^t \) is indeed the polytope we meant to construct.
   let \( F' = \Face(P,u') \) be facet, \( v \in F \) a vertex.
   - If \( F = F' \), then wlog. \( u'=u \) and \( u'(v_\eps) = b+\eps \).
   - If \( v \in F' \), then \( w \in F' \) where \( [v,w] \in E_1 \), so \( v_\eps \in F' \) and \( u'(v_\eps) = u'(v) = u'(F') \).
   - If \( v \notin F' \), then wlog. let \( v \in \Face(F,u') \). Clearly \( u'(w) > u'(v) \) for \( [v,w] \in E_1 \) as a \(u'\)-ascending path beginning in \( v \) must visit its only neighbour \( w \) outside of \( F \) first. But then \( u'(v_\eps) = u'(w+t([v,w])(v-w)) = (1-t([v,w]))u'(w) + t([v,w])u'(v) \leq u'(w) \leq u'(F')\).

   #+end_proof

   :NOTES:
   - *NOTE* This proof was way too complicated, don't need the last part at all.
     - new strategy: just replace the old vertices by the new ones.
     - then the integrals must vanish because we integrate over a geometric realisation.
     - edge directions are not changed by construction
   - hand-waving marker :) please fix
   :END:

   #+begin_theorem [Facet Formula]
   Let \( P \subset \mathbb{R}^n \) be a simple polytope.
   Then \( \dim(\EdgeCone_P) + \dim(P) = \text{number of facets} \).
   #+end_theorem
  
   #+begin_proof
   [Proof sketch]

   Let \( P \) be given by the (minimal set of) equality constraints \( h^ix = a^i, i \in I \) and facet-defining inequality constraints \(c^jx \leq b^j, j \in J \), with \( \#J \) being the number of facets.
   The dimension of the deformation cone \( \FacetCone_{\{h_i\},\{a_i\};\{c_j\},\{a_j\}} \) is \( \#J + \#I \), because we can perturb single entries \( b^j, j\in J \), giving us \( \#J \) linearly independent deformations.
   Thus \( \FacetCone_{\{h_i\},\{a_i\};\{c_j\},\{a_j\}} \) is full-dimensional, if we restrict \( P \) to the subspace generated by the \( h^i \).
   The rest of the deformations are translations in the \( \#I \) directions outside of that subspace.
   Hence \( \dim(\EdgeCone_P) + \dim(P)= (\dim(\FacetCone_{\{h_i\},\{a_i\};\{c_j\},\{a_j\}}) - n) + (n - \#I)= (\#J + \#I - n) + (n - \#I)= \#J \).
   #+end_proof

**** TODO Dimension
  #+index: deformation cone!dimension
In this section we determine the dimension of \( \DefCone_P \) for a simple polytope \( P \).
The idea is to show that you can slightly perturb each facet of \( P \) independently from the others while remaining in the deformation cone.
The simplicity assumption is important -- if \( P \) was, for instance, an icosahedron then the deformation cone has only dimension 1+3 (1 for dilation and 3 for translations), but \( P \) has 20 facets.


#+begin_lemma
Let \( C \subset \mathbb{R}^n \) be a polyhedron, \( a \in \mathbb{R}^{n*} \) a functional and \( b \in \mathbb{R} \), such that

\[ P \defeq C \cap \Set{x \in \mathbb{R}^n }{ a(x) \leq b } \]

is a simple polytope and \( \Face(P,a) \) is a facet.
Then there exists an open interval \( I \subet \mathbb{R} \) containing \( 0 \), such that

\[ P_\eps \defeq C\cap \Set{x\in \mathbb{R}^n}{ a(x) \leq b + \eps } \]

is a deformation of \( P \) for all \( \eps \in I \).
#+end_lemma
** [Extra] Lipschitz continuity

:NOTES:
- update notation
:END:

 #+begin_proposition
   Let \( s,t \in \EdgeCone_P \). Then the Cantor distance between \( (P,v_0)^{(w,t)} \) and \( (P,v_0)^{(w,s)} \) is bounded by \( \max_{v\in \Vertices{P}} \| v \| \| t - s \| \).
 #+index: Lipschitz continuity
 #+end_proposition

 #+begin_proof
   Let \( x \) be an arbitrary point of \( P^t \) and
   \( x = \sum_{v\in \Vertices{P}} \lambda_v v^{(w,t)} \) for \( \lambda_v \geq 0, \sum_{v\in \Vertices P} \lambda_v = 1 \) and define \( y = \sum_{v\in \Vertices{P}} \lambda_v v^{(w,s)} \in P^{(w,s)} \).
   Then \( \| x - y \| \leq \sum_{v\in\Vertices P} \lambda_v \| v^{(w,t)} - v^{(w,s)} \| \leq \max_{v \in \Vertices P} \| v\|\|t-s\| \).
 Analogously we find for an arbitrary point \( y \in P^s \) a point \( x \in P^{(w,t)} \) so that \( \| x - y \| \leq \max_{v \in \Vertices P} \| v\|\|t-s\| \).
   Therefore the Cantor distance is bounded by \( \max_{v\in \Vertices P} \| v \|\|t-s\| \).
 #+end_proof

* \( W \)-Permutahedra
** Introduction
   For each finite reflection group \( W \) acting on \( \mathbb{R}^n \) one may consider the convex hull of the orbit of one 'generic' point \( a \in \mathbb{R}^n \):
  
   \begin{equation}
   \Perm^a(W) \defeq \ConvexHull(Wa)
   \label{eq:permutahedron}
   \end{equation}

   Many concepts about finite reflection groups are reflected in this polytope and thus gain a geometric interpretation.
   Among these concepts are those of root, positive and simple systems, the weak Bruhat order, parabolic subgroups.
   We will study the deformation cone of permutahedra as an application of the notions we developed in the previous chapter.

** Finite reflection groups
   \label{sec:finite-reflection-groups}
   
   A finite reflection group \( (W,S) \) is a Coxeter group with generators \( S \) realised as a subgroup of the orthogonal group \( O(n) \), where the elements of \( s \in S \) are reflections, i.e. orthogonal transformations of the form

   \begin{equation}
   \refl_v(x) = x - 2\frac{\inner{x,v}}{\inner{v,v}}v \ForSome \text{ vector } v. \label{eq:refl}
   \end{equation}

   The /reflection axis/ \( v \) determines the direction of the reflection: \( \refl_v \) sends \( v \) to \( -v \) whereas the orthogonal complement to \( v \) remains fixed.
   A root system \( \Phi \) can be recovered from the set of reflections in \( W \):
   
   \begin{equation}
   \Phi \defeq \Set{ v \in \mathbb{R}^n }{ \|v\| = 1 \text{ and } \refl_v \in W }
   \label{eq:root-system}
   \end{equation}

   The roots of this particular root system are unit vectors.
   For the rest of this chapter, fix a positive system \( \Pi \defeq \{ v_1,...,v_N \} \subset \Phi \) containing a simple system \( \Delta \).

** Sign vectors and signed subsets

   The use of /sign vectors/ and /signed subsets/ will be of use in order to define the Coxeter complex which in turn gives us a description of the normal fan of a permutahedron.

   The 3-element set of /signs/
   #+index: sign
   \( \SPowerset{} \defeq \{ 0,+,- \} \) is partially ordered with covering relations \( 0 \sqsubset +, 0 \sqsubset - \).
   The meet of two elements always exists and is denoted by \( \sqcap \).
   The join of \(+ \) and \( - \) does not exist, but otherwise it does and is denoted \( \sqcup \).

   :FIGURE:
   #+caption: Hasse diagram of \( \SPowerset{} \)
   #+name: fig:sign-hasse-diagram
   #+attr_latex: :width 4cm
   [[./Figures/sign-hasse-diagram.jpg]]
   :END:

   We call \( \SPowerset{N} \defeq \{ 0,+,- \}^N \)
   #+index: \( \SPowerset{N} \) \see{sign vector}
   set of /sign vectors/
   #+index: sign vector
   (of length \( N \)).
   Equivalently we can view \( \SPowerset{N} = \{ -1,0,1 \}^N \)
   with identifications \( “+”=1, “-”=-1, “0”=0 \), and also equivalently we can define \( \SPowerset{[N]} \)
   #+index: \( \SPowerset{[N]} \) \see{signed subset}
   as set of pairs \( S = (S_+,S_-) \) of disjoint subsets of \( [N] \), which are called /signed subsets/ of \( [N] \).
   #+index: signed subset
   The set \( \SPowerset{[N]} \) itself goes by the name /signed powerset/ of \( [N] \).
   #+index: signed powerset
   The bijection between sign vectors and signed sets is given by
   
   :EQUATION:
   \begin{equation*}
   \begin{alignat*}{1}
   \SPowerset{N}   &\to    \ \SPowerset{[N]} \\
   s               &\mapsto\ (\Set{ i \in [N] }{s_i = +}, \Set{ i \in [N] }{ s_i = -})
   \end{alignat*}
   \label{eq:sign-vectors-signed-subsets-isomorphism}
   \end{equation*}
   :END:

   To us, all these notions are the same and will be used interchangeably when no confusion can arise.
   Therefore, in what follows, we will establish some notions regarding sign vectors and signed subsets in parallel.
   As a general rule, sign vectors are written as lower case letters \( s, t \) while signed subsets are denoted by capital letters \( S,T \).

   The partial order on /sign vectors/ is defined by
   #+index: sign vector
   \[ s \sqsubseteq t \defequiv s_i \sqsubseteq t_i \ForAll i \in [N]. \]
   The partial order has a bottom element
   \[ \bot = (0,...,0). \]
   The least upper bound (join) of two sign vectors \( s \) and \( t \) exists if and only if
   \[ \{s_i,t_i \} \neq \{+,-\}  \ForAll i \in [N], \]
   and if it exists it is given by
   \[ (s\sqcup t)_i = s_i\sqcup t_i \ForAll i \in [N]. \]
   On the other hand the greatest lower bound (meet) always exists and is given by
   \[ (s\sqcap t)_i = s_i \sqcap t_i \ForAll i \in [N]. \]
   The atoms are the vectors with all entries being \( 0 \) except for entry, for instance \( (+,0,0) \) is an atom in \( \SPowerset{3} \).
   The support of a signed vector \( s \) is the set
   \[ \supp(s) \defeq \Set{ i \in [N] }{ s_i \neq 0 }. \]

   The function
   \begin{alignat*}{2}
   \sign :\: & \mathbb{R}^N &\longrightarrow&     \SPowerset{N}
   \\         &            x &\longmapsto    &
   \begin{cases}
   1 & \text{ if } x > 0 \\
   0 & \text{ if } x = 0 \\
   -1 & \text{ if } x < 0 \\
   \end{cases}
   \end{alignat*}

   is called the /signum function/ (or sign function, which has the advantage of not being Latin and the drawback of sounding very similar to the sine function).
   #+index: signum function
   #+index: \( \sign \)
   
   Of course these concepts translate via the bijection \eqref{eq:sign-vectors-signed-subsets-isomorphism} to the world of signed subsets.
   The partial order takes the following form, for signed subsets \( S, T \in \SPowerset{[N]} \):
   \[ S \sqsubseteq T \defequiv S_+ \subseteq T_+ \text{ and } S_- \subseteq T_- \]
   The bottom element is
   \[ \bot = (\emptyset, \emptyset) \]
   The least upper bound (join) of \( S \) and \( T \) exists if and only if
   \[ S_+ \cap T_- = \emptyset = S_- \cap T_+ \]
   and if it exists then
   \[ S\sqcup T = (S_+ \cup T_+, S_- \cup T_-). \]
   The greatest lower bound (meet) is
   \[ S\sqcap T = (S_+\cap T_+, S_-\cap T_-). \]
   The support is defined as
   \[ \supp(S) = S_+ \cup S_-. \]
   Atoms are those signed subsets \( S \) whose support has cardinality 1, i.e.
   \[ \Card{\supp(S)} = 1. \]
   The signum function looks like this:
   \[ \sign(x) = (\Set{ i \in [N] }{ x_i > 0 }, \Set{i \in [N] }{ x_i < 0 }) \ForAll x \in \mathbb{R}^N. \]

** The Coxeter complex
   #+index: Coxeter complex

   The finite reflection group \( W \) acts on \( \mathbb{R}^n \).
   Recall the positive system \( \Pi \) we fixed in section \ref{sec:finite-reflection-groups}.
   To every functional \( c \) in the dual space \( \mathbb{R}^{n*} \) we can assign a sign vector
   
   \begin{equation}
   \sign(c,\Pi) \defeq (\sign(c(v_1)),...,\sign(c(v_N))) \in \SPowerset{N}
   \label{eq:coxeter-class}
   \end{equation}

   This partitions \( \mathbb{R}^{n*} \) into so called /Coxeter cells/
   #+index: Coxeter cell
   
   \begin{equation}
   C_s \defeq \Set{ c \in \mathbb{R}^{n*} }{ \sign(c,\Pi) = s } \For s \in \SPowerset{N}.
   \label{eq:coxeter-cell}
   \end{equation}

   Note that \( C_s \) may be empty for many sign vectors \( s \).
   Equipped with this notation we can define the fan \( \Sigma_W \) as
   
   \[ \Sigma_W \defeq \Set{ \overline{C}_s }{ s \in \SPowerset{N}, C_s \neq \emptyset }. \]

   Clearly this is a complete fan and

   \begin{equation}
   \overline{C}_s = \bigcup_{t \sqsubseteq s} C_t
   \label{eq:coxeter-cell-closure}
   \end{equation}

   The collection of sets \( \Set{ C_s }{ s \in \SPowerset{N}, C_s \neq \emptyset } \) is known as the /Coxeter complex/ and by using sign vectors we can understand its combinatorial structure.
   #+index: Coxeter complex

   The finite reflection group \( W \) acts on the dual space \( \mathbb{R}^{n*} \) via

   \begin{equation}
   wc \defeq c\circ w^{-1} \ForAll c \in \mathbb{R}^{n*}
   \end{equation}

   This group action extends to the Coxeter complex.

   #+begin_proposition
   \label{prop:action-on-coxeter-complex}
   The finite reflection group \( W \) acts on the Coxeter complex.
   #+end_proposition

   #+begin_proof
   Let \( C_s \neq \emptyset \) be a Coxeter cell and \( c \in C_s \).
   Let \( w \in W \) and note that \( w\Pi \subset \Phi \) is a positive system.
   So for each \( i \in [N] \) there exists an index \( i' \in [N] \) such that \( wv_{i'} = t_iv_i \ForSome t_i \in \SPowerset{} \) or equivalently \( t_iv_{i'} = w^{-1}v_i \).
   This also defines a sign vector \( t \in \SPowerset{N} \).
   Then \( (wc)(v_i) \defeq (c\circ w^{-1})(v_i) = t_ic(v_{i'}) \), hence
   \[ \sign(wc,\Pi) = (t_1s_{1'},...,t_Ns_{N'}), \]
   independent of the particular choice of \( c \).
   #+end_proof

** Fundamental domains                                 :i:am:hurting:save:me:
   #+index: fundamental domain
   
   Not every Coxeter cell \( C_s \) contains elements.
   Interestingly, which sign vectors \( s \) yield nonempty \( C_s \) is linked with which positive systems \( \Pi' \subset \Phi \) there are.
   
   #+begin_proposition
   For a positive system \( \Pi' \subset \Phi \) and its simple system \( \Delta' \subseteq \Pi' \) a fundamental domain of the \( W \)-action on \( \mathbb{R}^{n*} \) is
   \begin{equation}
   \FundamentalDomain(\Pi)
   \defeq \Set{ c \in \mathbb{R}^{n*} }{ c(v) \geq 0 \ForAll v \in \Pi' }
   = \Set{ c \in \mathbb{R}^{n*} }{ c(v) \geq 0 \ForAll v \in \Delta' }
   \label{eq:fundamental-domain}
   \end{equation}
   #+end_proposition

   #+begin_proof
   The equality \eqref{eq:fundamental-domain} is due to the fact that \( \Delta' \subset \Pi' \) and every vector in \( \Pi' \) lies in the positive hull of \( \Delta' \).
   That the right-hand side of equation \eqref{eq:fundamental-domain} is a fundamental domain is a consequence of [[cite:humpreys90_reflection_groups][Lemma 1.12]], which says that
   \[ \Set{ x \in \mathbb{R}^n }{ \inner{v,x} \geq 0 \ForAll v \in \Delta' } \]
   is the fundamental domain of the \( W \)-action on \( \mathbb{R}^n \).
   The claim follows from the fact that

   \begin{align*}
   \mathbb{R}^n \to&\ \mathbb{R}^{n*}
          x \mapsto&\ \inner{x,-}
   \end{align*}

   establishes an equivariant isomorphism, that is, it respects the \( W \)-action.
   #+end_proof
   
   
   Let's prove a special case of this observation before proving the more general theorem.

   #+begin_lemma
   \label{lem:generic-point}
   Let \( S = ([N],\emptyset) \in \SPowerset{[N]} \), then \( C_S \) is nonempty.
   #+end_lemma

   #+begin_proof
   The Coxeter complex forms a finite cover of \( \mathbb{R}^{n*} \) by measurable sets.
   However, if \( s \) is not a maximal element of \( \SPowerset{N} \), then \( C_s \) is contained in a linear subspace of positive codimension and thus has Lebesgue measure zero.
   
   
   Because elements of \( \Pi \) are nonnegative linear combinations of elements of \( \Delta \),

   \begin{equation}
   \Set{ x \in \mathbb{R}^n }{ \inner{x,v} \geq 0 \ForAll v \in \Delta } =
      \Set{ x \in \mathbb{R}^n }{ \inner{x,v} \geq 0 \ForAll v \in \Pi } \simeq
      \bigcup_{I\subseteq [N]} C_{(I,\emptyset)}
   \end{equation}

   holds, where the isomorphism is given by \( x \mapsto \inner{x,-} \).
   [[cite:humpreys90_reflection_groups][Lemma 1.12]] states that every point in \( \mathbb{R}^n \) is \( W \)-conjugate to some point in \( \Set{ x \in \mathbb{R}^n }{ \inner{x,v} \ForAll v \in \Delta } \), hence we obtain a finite cover
   
   \begin{equation}
   \mathbb{R}^{n*} = \bigcup_{w\in W} \Set{ c\circ w^{-1} }{ c \in \bigcup_{I\subseteq [N]} C_{(I,\emptyset)} }
   \end{equation}

   Among the sets \( C_{(I,\emptyset)} \) only \( C_{([N],\emptyset)} \) has possibly nonzero measure and therefore cannot be empty.
   #+end_proof

   #+begin_theorem
   Let \( s \in \SPowerset{N} \) be maximal, i.e. let it contain no \( 0 \)-entries.
   Then \( C_s \neq \emptyset \) if and only if \( \Set{ s_iv_i }{ i \in [N] } \) is a positive system.
   #+end_theorem

   #+begin_proof
   Assume that \( \Set{ s_iv_i }{ i \in [N] } \) is a positive system.
   All positive systems are conjugate by [[cite:humpreys90_reflection_groups][Theorem 1.4]], meaning that
   \begin{equation}
   \Set{ s_iv_i }{ i \in [N] } = w\Pi \ForSome w \in W.
   \label{eq:conjugate-positive-systems}
   \end{equation}
   Let \( c \in C_{(+,...,+)} \), which is nonempty by Lemma \ref{lem:generic-point}.
   By equation \eqref{eq:conjugate-positive-systems} there exists for each \( i \in [N] \) an index \( i' \in [N] \) such that \( wv_{i'} = s_iv_i \), or equivalently \( s_iv_{i'} = w^{-1}v_i \),
   and so \( c\circ w^{-1} \in C_s \):
   \[ (c\circ w^{-1})(v_i) = c(s_iv_{i'}) = s_ic(v_{i'}) = s_i \ForAll i \in [N] \]
   
  
   Conversely, let \( \inner{wa,-} \in C_s \).
   Then \( w\Pi \) is a positive system and
   for each \( v_i \) we find a sign \( c_i \) and a root \( v_j \) such that \( wv_j = c_iv_i \).
   But \( s_iv_i \defeq \sign\inner{wa,v_i}v_i = \sign\inner{a,c_iv_j}v_i = c_iv_i \), hence \( c_i = s_i \), as desired.
   #+end_proof

   #+begin_corollary
   \label{cor:positive-system-and-coxeter-cells}
   \( C_{s'} \neq \emptyset \) if and only if there exists \( s \sqsupseteq s' \) such that \( \{ s_iv_i \}_{i=1}^N \) is a positive system.
   #+end_corollary

   #+begin_proof
   \( C_{s'} \) is the relative interior of the face \( \overline{C}_{s'} \) of the non-empty cone \( \overline{C}_s \).
   #+end_proof
   
   #+begin_corollary
   \label{cor:fundamental-domain}
   If \( s \in \SPowerset{N} \) is maximal, then \( \overline{C}_s \) is either empty or a /fundamental domain/ with respect to the positive system \( \Set{ s_iv_i }{ i \in [N] } \).
   #+index: fundamental domain
   #+end_corollary

   #+begin_proof
   The set \( \Pi' \defeq \Set{ s_iv_i }{ i \in [N] } \) is a positive system by Corollary \ref{cor:positive-system-and-coxeter-cells}.
   If \( \inner{u,-} \in C_s \), then \( \sign\inner{u,s_iv_i} s_i \sign\inner{u,v_i} = s_i^2 = 1 \), hence \( \inner{u,-} \) lies in the fundamental domain \( \Pi' \).
   #+end_proof
   
   #+begin_corollary
   \label{cor:coxeter-cell-stabiliser}
   If \( \inner{u,-} \in C_s \) and \( w \in W \) with \( wu = u \), then \( w \) fixes \( C_s \).
   In other words, if we define the stabiliser \( W_s \defeq \Set{ w' \in W }{ \forall u' \in C_s:\, w'u' = u' } \) of \( C_s \), then \( wu=u \) implies \( w \in W_s \).
   In particular \( W_s = \Set{ w \in W }{ wu = u } \) is the stabiliser of \( u \).
   #+end_corollary

   #+begin_proof
   Suppose \( s' \in \SPowerset{N} \) is a maximal sign vector such that \( wu \in \overline{C}_{s'} \).
   Then surely
   \[ s'_i = \sign\inner{wu,v_i} = \sign\inner{u,v_i} = s_i \]
   holds if \( s_i \neq 0 \), that is, \( s' \sqsupseteq s \).
   Equation \eqref{eq:coxeter-cell-closure} then shows \( C_s \subset \overline{C}_{s'} \).
   The set \( \overline{C}_{s'} \) is a fundamental domain for some positive system \( \Pi' \) as Corollary \ref{cor:fundamental-domain} demonstrated.
   
   Let \( u' \in C_s \subset \overline{C}_{s'} \).
   We can conclude from the calculation
   \[ \inner{wu',v_i} = \inner{u',w^{-1}v_i} = \inner{u,w^{-1}v_i} = \inner{wu,v_i} \]
   that \( wu' \) and \( wu \) have the same sign vector, so both \( wu' \) and \( u' \) are contained in the fundamental domain \( \overline{C}_{s'} \).
   The uniqueness property of the fundamental domain [[cite:humpreys90_reflection_groups][Theorem 1.12.(a)]] finally tells us that \( wu' = u' \).
   #+end_proof

   #+begin_corollary
   The group \( W_s \) from Corollary \ref{cor:coxeter-cell-stabiliser} is generated by those reflections \( \refl_{v_i} \) for which \( s_i = 0 \).
   #+end_corollary
   
   #+begin_proof
   By \ref{cor:coxeter-cell-stabiliser} and [[cite:humpreys90_reflection_groups][Theorem 1.12.(d)]] we only need to check that \( \refl_{v_i} u = u \) if and only if \( s_i = 0 \).
   But \( s_i = 0 \) if and only if \( v_i \) is orthogonal to \( u \) which is in turn the same as saying \( \refl_{v_i} u = u \).
   #+end_proof

:NOTES:
#+begin_remark
- TODO: There are interpretations of the non-emptiness of \( C_s \) in terms of partial orders on \( [n] \) in the \( W = A_{n-1} \) case and partial orders on \( [n] \) together with a "marked subset" in case of \( W = B_n \). See cite:morton07_convex_rank_tests_semig.
#+end_remark
:END:

** Normal fan of \( W \)-Permutahedra                              :noexport:

   In this section we will see that the normal fan \( \NormalFan(\Perm^a(W)) \) is a coarsening of \( \Sigma_W \) and we will find that the latter equals the normal fan of \( \Perm^a(W) \) if and only if \( \sign(\inner{a,-},\Pi) \) is a maximal element of \( \SPowerset{N} \), that is, \( \inner{a,-} \) lies in some fundamental domain.
   #+index: normal fan
   In that case we call \( \Perm^a(W) \) a /permutahedron of type \( W \)/ or /\( W \)-permutahedron/.
   #+index: permutahedron
   Equivalently, \( \Perm^a(W) \) is a \( W \)-permutahedron if and only if the stabiliser of \( a \) in \( W \) is trivial.
   #+index: \( \Perm^a(W) \)
   The symmetry of this polytope leads us to our first observation

   #+begin_proposition
   The points in the orbit \( Wa \) are the vertices of \( \Perm^a(W) \).
   #+end_proposition

   #+begin_proof
   Without loss, assume that \( a \) is a vertex and choose a functional \( \inner{y,-} \) uniquely maximising \( a \).
   Then \( \inner{wy,-} \) uniquely maximises \( wa \), as \( w \in O(n) \).
   #+end_proof

   Suppose \( x \in \Perm^a(W) \) is a vertex and \( \inner{y,wx} \leq \inner{y,x} \) for all \( w \in W \).
   Then this inequality certainly holds if we only consider reflections \( w = \refl_{v_i} \), i.e. \( \inner{y,x} \geq \inner{y,\refl_{v_i}x} = \inner{y,x} - 2\frac{\inner{x,v_i}}{\inner{v_i,v_i}}\inner{y,v_i} \)
   which is equivalent to saying \( 0 \leq \inner{x,v_i} \inner{y,v_i} \).
   Hence \( \inner{y,-} \) maximises \( x \) only if \( \sign(\inner{x,-},\Pi) \sqcup \sign(\inner{y,-},\Pi) \) exists.
   This motivates the definition of the cones

   \[ N_x \defeq \bigcup \Set{ C_s }{ \sign(\inner{x,-},\Pi) \sqcup s \text{ exists} } = \bigcup \Set{ \overline{C}_{s'} }{ \sign(\inner{x,-},\Pi) \sqsubseteq s' } \]

   for \( x \in Wa \).
   The second equality is due to equation \eqref{eq:coxeter-cell-closure}.

   #+begin_lemma
   The sets \( N_x \) are cones and the collection of cones \( \Set{ N_{wa} }{ w \in W } \) and their faces form a complete fan \( \Sigma^a_W \).
   #+end_lemma
o
   #+begin_proof
   \( N_x \) is a union of cones and hence closed under multiplication by non-negative scalars.
   Next we'll see that \( N_x \) is also closed under addition:
   Let \( \inner{y,-},\inner{z,-} \in N_x \) and \( i \in [N] \).
   Remember that the \( v_i \) are the positive roots in \( \Pi \).
   If \( \inner{x,v_i} > 0 \), then \( \inner{y,v_i}, \inner{z,v_i} \) are nonnegative and thus \( \inner{y+z,v_i} \) is nonnegative as well.
   Similarly if \( \inner{x,v_i} < 0 \), then both \( \inner{y,v_i}, \inner{z,v_i} \) are nonpositive and so is \( \inner{y+z,v_i} \).
   Finally if \( \inner{x,v_i} = 0 \), then no conditions are imposed on \( \inner{y,v_i}, \inner{z,v_i}, \inner{y+z,v_i} \).
   Therefore \( \inner{y+z,-} \in N_x \).
   Clearly
   \[ N_{wa} \cap N_{w’a} = N_{wa} \cap \bigcap \Set{ H_i }{ \{\sign\inner{wa,v_i},\sign\inner{w'a,v_i}\} = \{ +,- \} }, \]
   so intersections of two cones are faces of both.
   Every \( y \in \mathbb{R}^n \) is contained in some normal cone \( \NormalCone(wa,\Perm^a(W)) \subseteq N_{wa} \), hence completeness follows.
   #+end_proof

   A consequence of this lemma and our *PREVIOUS CONSIDERATIONS* is that \( \NormalFan(\Perm^a(W)) \) is a refinement of \( \Sigma^a_W \), as the identity on \( \mathbb{R}^n \) induces a morphism of fans \( \NormalFan(\Perm^a(W)) \to \Sigma^a_W \).
   In particular
   \[ N_{wa} = \bigcup \Set{ \NormalCone(w'a,\Perm^a(W)) }{ \sign(\inner{w'a,-},\Pi) = \sign(\inner{wa,-},\Pi) }. \]
   In fact we argue that 
   \[ N_{wa} = \NormalCone(wa,\Perm^a(W)): \]
   Let \( s \sqsupseteq \sign(\inner{w'a,-},\Pi) = \sign(\inner{wa,-},\Pi) \) be a maximal sign vector.
   Corollary \ref{cor:fundamental-domain} establishes that the nonempty set \( \overline{C}_s \) is a fundamental domain and [[cite:humpreys90_reflection_groups][Theorem 1.12.(a)]] tells us that if \( \inner{wa,-} \) and \( \inner{w'a,-} \), are contained in a fundamental domain, then \( wa = w'a \).
   As this is the case the equality \( wa = w'a \) holds and we thus have also proven
   
   #+begin_theorem
   \( \NormalFan(\Perm^a(W)) = \Sigma^a_W \).
   #+end_theorem

   #+begin_corollary
   For arbitrary \( a \), \( \Perm^a(W) \) is the summand of a \( W \)-permutahedron.
   #+end_corollary

   Now we turn our eye towards \( W \)-permutahedra, so we choose \( a \in \mathbb{R}^n \) with maximal sign vector \( \sign(\inner{a,-},\Pi) \) and normal fan \( \NormalFan(\Perm^a(W)) = \Sigma_W \).
   #+index: normal fan
   We assume without loss, that \( \sign(\inner{a,-},\Pi) = ([N],\emptyset) \), that is, \( a \) lies in the interior of the fundamental domain.

   #+begin_corollary
   If \( \Perm^a(W) \) is a  \( W \)-permutahedron, then \( \NormalFan(\Perm^a(W)) = \Sigma_W \).
   #+end_corollary
   #+begin_proof
   \( \sign(\inner{wa,-},\Pi) \) is maximal and therefore
   \[ N_{wa} =  \bigcup \Set{ \overline{C}_{s'} }{ \sign(\inner{wa,-},\Pi) \sqsubseteq s' } =  \overline{C}_{\sign(\inner{wa,-},\Pi)}. \]
   #+end_proof

** Tangent cones and simple systems                                :noexport:

Knowing the normal fan we can give a nice description of the tangent cones.

#+begin_theorem
\label{thm:simple-system-spans-tangent-cone}
Let \( wa \) be a vertex of the \( W \)-permutahedron \( \Perm^a(W) \).
The set
\[ \Set{ \frac{y - wa}{\|y-wa\|} }{ [wa,y] \in \Edges \Perm^a(W) } \]
is a simple system.
#+index: simple system
#+index: tangent cone
#+end_theorem
#+begin_proof
It suffices to show that the tangent cone at \( wa \) is spanned by the vectors of the positive system \( w\Pi \).
Let \( s = \sign(\inner{wa,-},\Pi) \).
The tangent cone at \( wa \) is the dual cone of the normal cone \( \overline{C}_{s} = \Set{ y \in \mathbb{R}^d }{ \inner{y,s_iv_i} \geq 0 \text{ for all } i } \).
Thus the tangent cone is spanned by the elements of the simple system within \( w\Pi \).
#+end_proof

#+begin_corollary
\label{cor:vertex-simple-system-bijection}
The map from \( \Vertices \Perm^a(W) \) to the powerset \( \Powerset\Phi \) defined by

\[
v \mapsto \Set{ r \in \Phi }{ r \text{ spans an extremal ray of the tangent cone } \TangentCone(v,\Perm^a(W)) }
\]

establishes a bijective correspondence between simple systems of \( W \) and the vertices of the \( W \)-permutahedron \( \Perm^a(W) \).
#+end_corollary

#+begin_proof
Let \( \Delta' \subset \Phi \) be a simple system.
Theorem \ref{thm:simple-system-spans-tangent-cone} asserts that the extremal rays of the tangent cone at vertex \( a \) are spanned by a simple system \( \Delta \).
All simple systems are conjugate [[cite:humpreys90_reflection_groups][Theorem 1.4]], hence we may write

\[ \Delta' = w\Delta \text{ for some } w \in W. \]

However, the tangent cone at \( wa \) is \( \TangentCone(wa,\Perm^a(W)) = w\TangentCone(a,\Perm^a(W)) \), and thus the simple system at \( wa \) is precisely \( w\Delta \), establishing surjectivity of the assignment \( vertex \mapsto simple\ system \).
Injectivity follows from the fact that two distinct vertices have two distinct normal cones, and thus also two distinct tangent cones.
#+end_proof


#+begin_corollary
The edge directions of the \( W \)-permutahedron are given by the root system \( \Phi \) of \( W \).
#+end_corollary

#+begin_proof
The theorem clearly tells us that every edge direction can be rescaled to belong to some simple system in \( \Phi \).
Conversely let \( \Delta \) be the simple system belonging to the generators \( S \) of \( W \) and without loss assume that \( a \) is the vertex for this simple system, by virtue of Corollary \ref{cor:vertex-simple-system-bijection}.
Then a root \( r \in \Phi \) yields a reflection \( s_1...s_{k-1}s_ks_{k-1}...s_1 \in W \) along \( r \).
If \( s_k \) is the reflection along the root \( r' \), then \( r = \pm s_1...s_{k-1}r' \),
so \( r \) is an edge direction at the vertex \( s_1...s_{k-1}a \).
#+end_proof

#+begin_corollary
\( W \)-permutahedra are simple polytopes.
#+end_corollary

#+begin_proof
The tangent cone \( \TangentCone(wa,\Perm^a(W)) \) at \( wa \) has dimension \( \dim(\Perm^a(W)) \) and is spanned by a simple system, which is a basis of \( \Span\TangentCone(wa,\Perm^a(W)) \) and therefore has cardinality \( \dim(\Perm^a(W)) \).
#+end_proof

** Faces and parabolic subgroups                                   :noexport:

#+begin_lemma
\label{cor:parabolic-subgroups}
The stabilisers \( W_s \defeq \Set{ w \in W }{ \forall u \in C_s:\, wu = u } \) for \( s \in \SPowerset{N} \) are the /parabolic subgroups/[fn::These are subgroups generated by a subset of reflections given by some fixed simple system].
#+index: parabolic subgroup
#+end_lemma

#+begin_proof
This holds by Corollary \ref{cor:coxeter-cell-stabiliser} and [[cite:humpreys90_reflection_groups][Proposition 1.15]].
#+end_proof

#+begin_proposition
Let \( \Face(\Perm^a(W), u^*) \) be a face with \( u^* \defeq \inner{u,-} \in C_s \) and containing a vertex \( x \).
Then the vertices of \( \Face(\Perm^a(W),u^*) \) is the orbit of \( x \) under the action by the parabolic subgroup \( W_s \subseteq W \).
In other words
\[ \Face(\Perm^a(W),u^*) = \Perm^x(W_s). \]
#+end_proposition

#+begin_proof
\( u^* \) is contained some fundamental domain \( \overline{C}_s \).
Suppose \( wx \) is a vertex of \( \Face(\Perm^a(W),u^*) \), then \( u^* \) is surely contained in the normal cone of \( wx \).
Considering that \( (wu)^* \defeq \inner{wu,-} \) is also contained in the normal cone of \( wx \), both \( u^* \) and \( (wu)^* \) are contained a fundamental domain \( \overline{C}_s \), hence by [[cite:humpreys90_reflection_groups][Theorem 1.12.(a)]] the equality \( wu = u \) must hold.
Conversely, if \( wu = u \), then \( wx \) is a maximiser of \( wu \) because \( x \) is a maximiser of \( u \) and \( \inner{wu,wx} = \inner{u,x} \).
#+end_proof

#+begin_corollary
Every face of a permutahedron is again a permutahedron.
#+end_corollary

#+begin_proof
Let \( \Face(\Perm^a(W,u^*) \) be a face of a permutahedron with \( u^* \defeq \inner{u,-} \in C_s \) and let \( x \) be a vertex on that face.
Note that the stabiliser \( W_x = W_a = 1 \), hence \( (W_s)_x \subseteq W_x = 1 \).
#+end_proof

** Zonotope representation                                         :noexport:

 If \( \dim W = 2 \), then \( W \) is a dihedral group and therefore generated by rotations and multiplication by \( -1 \) (in the Euclidean plane).
 In particular, \( \Perm^a(W) \) is centrally symmetric.
 From this simple fact we can derive the following result.

 #+begin_theorem
 Every \( W \)-permutahedron is a zonotope.
 #+index: zonotope
 #+end_theorem
 #+begin_proof
 Every 2-dimensional face of a \( W \)-permutahedron is again a permutahedron, and thus centrally symmetric.
 By [[cite:bjorner99_oriented_matr][Proposition 2.2.14]] this implies already that \( \Perm^a(W) \) is a zonotope.
 #+end_proof

 #+begin_corollary
 \( \Perm^a(W) = \sum_i \lambda_i [-v_i,v_i] \) for some \( \lambda_i > 0 \).
 #+end_corollary
 #+begin_proof
 See [[cite:bjorner99_oriented_matr][Proposition 2.2.14]]
 #+end_proof
** Weak Bruhat order                                               :noexport:
\label{sec:weak-bruhat-order}

Let \( S \subset W \) be the simple system corresponding to the edges at the vertex \( a \in \Perm^a(W) \).
What is the simple system corresponding to edges at arbitrary vertices \( wa \in \Perm^a(W) \) for \( w \in W \)?
Suppose \( s \in S \) and \( s = s_r \) where \( r \) is the root spanning the edge direction of the edge belonging to \( s \).
Then \( s_{wr} = ws_rw^{-1} = wsw^{-1} \) and therefore the simple system simple system at vertex \( wa \) is just \( wSw^{-1} \).
This means that the neighbouring vertices of \( wa \) are \( (wsw^{-1})wa = wsa \) for \( a \in S \), i.e. the neighbours are those \( w' \in W \) which cover \( w \) or are covered by \( w \) in the right weak Bruhat order[fn::For a definition we refer to [[cite:anders05_combin_coxet][section 3.1]]].
This gives us an interpretation of the Hasse diagram for the right weak Bruhat order as the graph of \( \Perm^a(W) \) or as /Cayley graph/ of \( W \) with generators \( S \).
#+index: Cayley graph
#+index: right weak Bruhat order

** Linear embedding of the fundamental domain into the deformation cone :noexport:
Let \( s \in \SPowerset{N} \) and \( C_s \) a Coxeter cell such that \( \inner{a,-} \in C_S \).
We can embed \( C_s \) linearly into the vertex deformation cone of \( \Perm^a(W) \) via

\[ \inner{x,-} \mapsto (wx)_{wa\in \Vertices \Perm^a(W)}. \]

We claim that this map is well-defined, linear and injective.
The latter two properties are obvious once the first is shown to be true.

Let \( \inner{x,-} \in C_s \).
Because both \( \Perm^a(W) \) as well as \( \Perm^x(W) \) are permutahedra, their graphs are isomorphic and given by the weak Bruhat order, as described in section \ref{sec:weak-bruhat-order}.
Note that the normal cones \( \NormalCone(a,\Perm^a(W)) \) and \( \NormalCone(x,\Perm^x(W)) \) are the same and equal \( \overline{C}_s \).
It is easy to see that
\begin{equation}
\label{eq:same-normal-cone}
\NormalCone(wa,\Perm^a(W)) = \NormalCone(wx,\Perm^x(W))
\end{equation}
holds in fact for all \( w \in W \).
Let \( [wa,w'a] \in \Edges \Perm^a(W) \) be an edge and \( [wx,w'x] \in \Edges \Perm^a(W) \) be the corresponding edge in \( \Perm^x(W) \).
Then each functional \( u \) with \( u(wa) > u(w'a) \) also satisfies \( u(wx) > u(w'x) \) by equation \eqref{eq:same-normal-cone}.
Thus, for some real number \( t \), \( wa - w'a = t(wx-w'x) \) and so
\[ t = u(wa-w'a)/u(wx-w'x) > 0. \]
Well-definedness is thus proven.

Note that the closure \( \overline{C}_s \) is a fundamental domain and therefore the embedding of \( C_s \) into the deformation cone of \( \Perm^a(W) \) extends to the embedding of the fundamental domain into the deformation cone.
This shows

#+begin_theorem
The map \( \overline{C}_s \to \DefCone_{\Perm^a(W)} \) given by
\[ \inner{x,-} \mapsto \Perm^x(W) \]
embeds the fundamental domain linearly into the deformation cone of the \( W \)-permutahedron.
#+end_theorem

We can even characterise elements of the fundamental domain:

#+begin_proposition
A deformation \( Q \in \DefCone_{\Perm^a(W)} \) lies in the embedding of the fundamental domain if and only if \( wQ = Q \) for all \( w \in W \).
#+end_proposition

#+begin_proof
If \( Q \) is of the form \( \Perm^x(W) \), then \( Q \) is of course invariant under the action of \( W \), so one direction is obvious.

Thus assume \( wQ=Q \) for all \( w \in W \) and let \( x \in \Vertices Q \).
Clearly \( Q'\defeq \Perm^x(W) \subseteq Q \).
Let \( x' \in Q \) be another vertex.
Because \( Q \) is a deformation of \( \Perm^a(W) \),
\( \{x'\} = \Face(Q,wu) \) where \( w \in W \) and \( \{x\} = \Face(Q',u) \).
But \( w^{-1}Q= Q\), so 
\[ \{x'\} = \Face(Q,wu) = w\Face(w^{-1}Q,u) = w\Face(Q,u) = w\{x\} = \{wx\}. \]
This shows that \{ x' \} was in fact a vertex of \( Q' \) establishing \( Q' \supseteq Q \).
#+end_proof

** TODO Standard H-representation                                  :noexport:
*** General Computation

    In this section we will describe an H-representation for the permutahedron \( \Perm^a(W) \).
    Let \( \Delta \) be a simple system.
    The reflection group \( W \) is essential relative to \( \Span(\Delta) \).
    Let \( a_1,...,a_{\codim(\Perm^a(W))} \) be a basis of

    \begin{equation}
    \Set{ c \in \mathbb{R}^{n*} }{ c(x) = 0 \ForAll x \in \Delta }, \label{eq:orthogonal-complement-of-simple-system}
    \end{equation}

    which is isomorphic to the orthogonal complement of \( \Perm^a(W) \).
    We define the index set \( I \defeq [\codim(\Perm^a(W))] \) accordingly.

    Next choose for each root \( \rho \in \Delta \) a facet normal
    \[ \nu_x \in \Set{ c \in \mathbb{R}^{n*} }{ c(x) = 0 \ForAll x \in \Delta \setminus \rho }, \]
    which does not lie in \eqref{eq:orthogonal-complement-of-simple-system}.

    Theorem \label{thm:simple-system-spans-tangent-cone}
    Corollary \ref{cor:vertex-simple-system-bijection}

    #+begin_remark
    The orbits of the normals at \( v \) are disjoint.
    #+end_remark


    :EQUATION:
    \begin{equation}
    P = \Set{ x \in \mathbb{R}^n }{
    \begin{aligned}
    a_i(x)    =\,& \tilde{b}_i \quad \ForAll i \in I \\
    a_j(x) \leq\,& \tilde{b}_j \quad \ForAll j \in J
    \end{aligned} }
    \label{eq:deformations-of-permutahedra-normal-form}
    \end{equation}
    :END:


    #+begin_proposition
    [Standard H-representation]

    Given a simple system \( \Delta \) one obtains a description of \( \Perm^a(W) \) by a system of inequalities as follows:
    Choose a basis \( H = \{ h_1,...,h_c \} \) of \( \Delta^\perp \defeq \Set{ u \in \mathbb{R}^{n*}}{ \forall v' \in \Delta:\, uv' = 0 } \).
    For each \( v \in \Delta \), choose \( g_v \in (\Delta \setminus v)^\perp \defeq \Set{ u \in \mathbb{R}^{n*}}{\forall v' \in \Delta, v\neq v':\, uv' = 0 } \) with \( g_v v < 0 \).
    Define \( G = W\Set{ g_v }{ v \in \Delta } \defeq \Set{ g_v\circ w^{-1} }{ v \in \Delta, w \in W } \).
    Then there are coefficients \( z'_h, h \in H \) and \( z_g, g \in G \) such that
    \[ \Perm^a(W) = \Set{ x \in \mathbb{R}^d }{ \forall h\in H:\, hx = z'_h, \forall g\in G:\, gx \leq z_g }. \]
    Since simple systems are conjugate the particular choice of the simple system doesn't matter.
    #+end_proposition

    #+begin_proof
    The \( g_v \) are the outer normals of the faces adjacent to the vertex of \( \Perm^a(W) \) associated with \( \Delta \), as the tangent cone is spanned by the simple system.
    By symmetry these are all the outer normals.
    #+end_proof

    We'll use this result to compute H-representations for some concrete examples.


*** Type A_{n-1}
 #+index: permutahedron ! type A
 \( W = A_{n-1} = S_n \subset O(n) \).
 A simple system \( \Delta \) is given by \( v^{(i)} = e_i - e_{i+1} \) for \( i \in [n-1] \).
 \( \Delta^\perp = \Span (\sum_{i=1}^n e_i^*) \).
 \( (\Delta\setminus v^{(i)})^\perp \setminus \Delta^\perp \) consists precisely of those dual vectors \( x = \sum_{i=1}^n x_ie_i^* \) with \( x_1=...=x_i=A, x_{i+1}=...=x_n=B \) and \( x_1+...+x_n = iA + (n-i)B \neq 0 \).
 We may choose \( B = 0 \) and \( A = 1 \), so \( x = g_{[i]} \) where \( (g_I)_i \defeq \begin{cases} 1,& i\in I, \\ 0, & i \notin I \end{cases} \).
 Obviously the orbit of the \( g_{[i]} \) under \( S_n \) consists of those \( g_J \) such that \( \emptyset \subsetneq J \subsetneq [n] \).
 To summarise our findings:

 #+begin_proposition
 There exist real numbers \( z_J \) for \( \emptyset \subsetneq J \subseteq [n] \), such that
 \[ \Perm^a(B_n) = \Set{ x \in \mathbb{R}^n }{ \sum_{i=1}^n x_i = z_{[n]}, \sum_{i \in J} x_i \leq z_i, (\emptyset \subsetneq J \subsetneq [n]) }. \]
 #+end_proposition

 Note that \( -\Perm^{a}(A_{n-1}) = \Perm^{-a}(A_{n-1}) \) is a permutahedron as well, so we also obtain for the same coefficients as in the proposition
 \[ \Perm^{-a}(A_{n-1}) = \Set{ x \in \mathbb{R}^n }{ \sum_{i=1}^n x_i = -z_{[n]}, \sum_{i \in J} x_i \geq -z_i, (\emptyset \subsetneq J \subsetneq [n]) }. \]

*** Type B_n
 #+index: permutahedron ! type B
 \( W = B_n = \{1,-1\}^n \rtimes S_n \) where \( \{1,-1\}^n \) acts on \( \mathbb{R}^n \) via pointwise multiplication, which in this case means change of sign.
 \( B_n \) acts on \( \mathbb{R}^n \) via sign change followed by permutation.
 The simple system \( \Delta \) is given by \( v^{(i)} = e_i - e_{i+1} \) for \( i \in [n-1] \) and \( v^{(n)} = e_n \).
 \( \Delta^\perp = 0 \). For \( i \in [n-1] \) \( (\Delta \setminus v^{(i)})^\perp \setminus 0 \) consists of those dual vectors \( x=\sum_{i=1}^n x_ie_i^* \) of the form \( x_1 = ... = x_i = A, x_{i+1}=...=x_n=0 \), so we may choose \( x = g_{[i]} \).
 If \( i = n \), choose \( x = g_{[n]} = \sum_{i=1}^n e_i^* \).
 Therefore \( B_n\Set{g_J }{ \emptyset \subsetneq J \subseteq [n] } = \Set{ \sum_{i=1}^n s_ie_i^* }{ s \in \SPowerset{n} \setminus \{ 0 \} } \).

 #+begin_proposition
 There exist real numbers \( z_s \) for non-zero \( s \in \{0,1,-1\}^n \), such that
 \[ \Perm^a(B_n) = \Set{ x \in \mathbb{R}^n }{ \sum_{i=1}^n s_ix_i \leq z_s \text{ for all non-zero } s \in \{0,1,-1\}^n}. \]
 #+end_proposition

*** Type D_n                                                 :draft:noexport:
#+index: permutahedron ! type D

** TODO H-representation of the facet deformation cone             :noexport:
*** TODO Generic Approach

We give a recipe for computing the deformation cone of a \( W \)-permutahedron \( \Perm^a(W) \) based on section \ref{sec:deformations-of-simple-polytopes}.
Remember that we needed to compute the /vertex basis matrices/ for each vertex.
This simplifies due to the symmetry caused by the \( W \)-action to 

#+begin_definition
Compatible system of inequalities.
#+end_definition

#+begin_lemma
Let \( v \in \Perm^a(W) \) be a vertex, and let \( wv \) be an adjacent vertex for \( w \in W \).
Furthermore let the system of inequalities be compatible/symmetric/invariant.
\[ \{a_i\} = B_v \setminus B_{wv} \implies \{ wa_i \} = B_{wv} \setminus B_v \]
#+end_lemma


This means that we have to compute the /adjacent vertices/ function \( \mathsf{adj} \), as well as the /vertex basis matrix/ \( \tilde{B} \) and its inverse.
To avoid maintaining a lot of vertex basis matrices, we have modified the procedure slightly.
Instead of picking a vertex \( v \), a facet \( f \) touching \( v \) and then determining the vertex \( v' \) adjacent to \( v \) away from \( f \) we start with \( v' \), then find the adjacent vertex \( v \) and then determine \( f \) containing \( v \) but not \( v' \).
This facet \( f \) we call /opposite facet/.
#+index: opposite facet
You can verify that this modification leads to the same set of inequalities.

Let \( w \in W \) which determines the vertex \( wa \in \Perm^a(W) \).
Let \( a_i, i \in I \) be a basis of functionals constant on \( \Perm^a(W) \) with \( \# I = n - \dim \Perm^a(W) \).
Let \( F \) be the set of facets of \( \Perm^a(W) \) and choose facet normals \( a_f \) for \( f \in F \) satisfying

\[ \forall w \in W: a_f \circ w^{-1} = a_{wf}. \]

With this we may write

\[ \Perm^a(W) \defeq P(b) \defeq \Set{ x \in \mathbb{R}^n }{ a_ix = b_i, a_f x \leq b_f, i\in I, f\in F } \]

Further define \( B_w \defeq I \dot\cup \Set{ f \in F }{ wa \in f } \), which can be thought of a set of supporting hyperplanes meeting in the vertex \( wa \).
Clearly \( \Set{ a_k }{ k \in B_w } \) forms a basis of \( \mathbb{R}^{n*} \).
As a consequence \( B_w \) determines a linear isomorphism -- our vertex basis matrix:

\begin{alignat*}{2}
\tilde{B}_w : & \mathbb{R}^n  &\to    & \mathbb{R}^{B_w}
\\            & x             &\mapsto& (a_k x)_{k \in B_w}
\end{alignat*}

The adjacent vertices \( v \) of \( wa \) are determined by choice of \( f \in B_w \cap F \):
Let \( L \defeq \bigcap_{k\in B_w \setminus f} \ker a_k \) be the edge direction of \( [wa,v] \).
We have seen in Theorem \ref{thm:simple-system-spans-tangent-cone} that \( L \) contains a root \( r \), so the reflection

\[ s(w,f) \defeq x \mapsto x - 2\frac{\inner{r,x}}{\inner{r,r}} r \]

is contained in \( W \).
However all three vertices \( s(w,f)wa, wa, v \) lie on \( wa + L \) while \( wa \) is distinct from the other two.
Hence \( s(w,f)wa = v \) and we may write

\[ \mathsf{adj}(wa,f) \defeq v = s(w,f)wa \]

for the adjacent vertex to \( wa \) away from \( f \).
Clearly

\[ B_{s(w,f)w} = B_w \setminus f \cup s(w,f)f \]

The normal of the opposite facet is given by reflecting the normal \( a_f \), i.e.
\[ a_f\circ s(w,f)^{-1} = a_f \circ s(w,f), \]
and thus we obtain the following set of inequalities for \( b \in \mathbb{R}^{I\cup F} \):

\begin{equation}
\forall f \in B_w \cap F: b_{s(w,f)f} \geq \left(a_f\circ s(w,f)^{-1} \circ \tilde{B}_w^{-1} \right) b|_{B_w} \label{eq:symmetrised-inequalities}
\end{equation}

The other inequalities can be obtained by choosing a different vertex \( wa \), say \( w'wa \).
In fact, had we started with \( w'wa \) as a vertex we would get the same inequalities, up to certain permutations of the entries of \( b \).
To see this, note that

- \( B_{w'w} = w'B_w = \Set{ w'k }{ k \in B_w } \) if we define the action of \( W \) on \( I \) to be trivial.
- \( s(w'w,w'f) = w's(w,f)w'^{-1} \) for \( f \in B_w \) (or equivalently for \( w'f \in B_{w'w} \)), because
  \[ w'g \in \bigcap_{k\in B_{w'w} \setminus w'f} \ker a_k = \bigcap_{k\in B_w \setminus f} \ker a_k \circ w'^{-1} \]
  and \( s_{w'g} = w' \circ s_g \circ w'^{-1} \)
- hence
  \[ a_{s(w'w,w'f)w'f} = a_{w's(w,f)f} \]
  and
  \[ b_{s(w'w,w'f)w'f} = b_{w's(w,f)f} \]
- and finally \( \tilde{B}_{w'w} = \tilde{B}_w \circ w'^{-1} \) due to \( a_{w'k} = a_k \circ w'^{-1} \) for all \( k \in B_w \)

If we define \( b^{w'}_k = b_{w'k} \), then we obtain as a consequence of above observations,

\[ \forall f \in B_w \cap F: b^{w'}_{s(w,f)f} \geq (a_f \circ s(w,f)^{-1} \circ \tilde{B}_w^{-1}) b^{w'}|_{B_f} \]

with the linear transformation \( A_{w,f} \defeq a_f \circ s(w,f)^{-1} \circ \tilde{B}_w^{-1} \) being independent of \( w' \).
Compare this with formula \ref{eq:symmetrised-inequalities}.

Applying the general theorem for simple polytopes we now get

#+begin_theorem
Let \( w_0 \in W \).
Using above notation \( P(b) \) is a deformation of \( \Perm^a(W) \) with tight \( b \) if and only if for all \( w' \in W, f \in B_w \cap F \)
\[ b^{w'}_{s(w,f)f} \geq A_{w,f} b^{w'}|_{B_w}\]
#+end_theorem

Using this result we give descriptions for the deformation cone of permutahedra of type A, B and D via linear inequalities.

*** TODO Type A_{n-1}
 #+index: permutahedron ! type A

Consider the permutahedron \( \Perm^a(A_{n-1}) = \Set{ x \in \mathbb{R}^n }{ a_{[n]}x = b_{[n]}, a_I x \leq b_I, \emptyset \subsetneq I \subsetneq [n] } \) where \( a_I \defeq \sum_{i\in I} e_i^* \).
Let \( wa \) be the vertex corresponding to the simple system[fn:: see [[cite:humpreys90_reflection_groups][Section 2.10]]] \( -r_i = e_i - e_{i+1} \) for \( i \in [n-1] \).
The facets containing \( wa \) are \( a_i \defeq a_{I_i}, i \in [n-1] \), where
\( I_i \subset [n] \) is defined via \( a_{I_i} r_i \leq 0 \) and \( a_{I_i} r_j = 0 \) for all \( i \neq j \in [n-1] \).
A simple computation shows \( I_i = [i] \).
Now fix \( i \in [n-1] \).
Recall that the reflection \( s(w,i) \) just permutes the \( i \)^{th} and the \( (i+1) \)^{th} entries, so we get opposite facets \( s(w,i)i \) to \( wa \) and
\[ a_{s(w,i)i} = \sum_{j=1}^{i-1} e_j^* + e_{i+1}^* \]
and
\[ b_{s(w,i)i} = b_{[i-1]\cup (i+1)}. \]
It turns out that \( \tilde{B}_w^{-1} \) is given by
\[ c_i \defeq (\tilde{B}_w^{-1} b|_{B_w})_i = b_{[i]} - b_{[i-1]}, \]
with the convention
\[ b_{\emptyset} = 0. \]
which can be recognised as the Möbius inversion on the chain \( [n-1] \).
Therefore,

\[ b_{[i-1] \cup (i+1)} = A_{w,i} b|_{B_w} = \sum_{j=1}^{i-1} c_j + c_{j+1} = b_{[i-1]} + b_{[i+1]} - b_{[i]}, \]

which can be written
\[ b_{[i-1]\cup (i+1)} + b_{[i-1] \cup i} \geq b_{[i-1]} + b_{[i+1]} \]
After applying the action by \( A_{n-1} = S_n \), this yields the /reduced submodular inequalities/:

#+begin_corollary
\( \Set{ x \in \mathbb{R}^n }{ a_{[n]}x = b_{[n]}, a_I x \leq b_I, \emptyset \subsetneq I \subsetneq [n] } \) is a deformation of the \( A_{n-1} \) permutahedron if and only if
for non-empty \( I \subset [n] \) of cardinality at most \( n-2 \) and \( i,j \) distinct elements of \( [n] - I \), we have

\[ b_{I\cup i} + b_{I\cup j} \geq b_I + b_{I \cup \{i, j\}} \]
#+end_corollary


cite:ardila08_matroid_polyt_their_volum,morton07_convex_rank_tests_semig characterised  the right-hand sides which define deformations of \( \Perm^a(A_{n-1}) \) via the /submodular inequalities/
\[ b_I + b_J \geq b_{I\cap J} + b_{I\cup J} \quad \text{ for } I,J \subseteq [n], \]
which is clearly contains the reduced submodular inequalities.
We want to show that both systems of linear inequalities are in fact equivalent, which completes the proof of [[cite:morton07_convex_rank_tests_semig][Proposition 12]].

#+begin_proposition
[[cite:nguyen78_semimodular][Theorem 1.2.1]].

A function \( f : \Powerset{[n]} \to \mathbb{R}^n, f(\emptyset) = 0 \) satisfying the reduced submodular inequalities also satisfies the submodular inequalities.
#+end_proposition
#+begin_proof
Assume that \( f : \Powerset{[n]} \to \mathbb{R} \) satisfies the reduced submodular inequalities, i.e.
\[ f(I\cup \{i\}) + f(I\cup \{j\}) \geq f(I) + f(I\cup\{i,j\}) \]
whenever \( I \subset [n], i,j \in [n] \setminus I, i\neq j \).

Instead of showing that \( f(I) + f(J) \geq f(I\cap J) + f(I\cup J) \) for subsets \( I,J \subseteq [n] \), we can equivalently show
\[ f(I\cup S_1) + f(I\cup S_2) \geq f(I) + f(I\cup S_1 \cup S_2) \]
for pairwise disjoint subsets \( I,S_1,S_2 \subset [n] \).
Note, that the inequality holds trivially if \( S_1 = \emptyset \) or \( S_2 = \emptyset \), so we may assume \( S_1, S_2 \) to be non-empty.

We will proceed with a proof by induction on \( \#(S_1\cup S_2) \).
If \( \#(S_1 \cup S_2) = 1 \), then either \( S_1 \) or \( S_2 \) is empty and there is nothing to show.
If \( \#(S_1 \cup S_2) = 2 \), then \( S_1=\{ i \}, S_2 = \{ j \} \), so the inequality holds by assumption.
Now assume that the hypothesis holds for \( \#(S_1\cup S_2) \leq r < n \).
Let \( I,S_1, S_2 \) be disjoint subsets such that \( \#(S_1\cup S_2) = r+1 \).
Without loss we may assume \( \#S_1 \geq 2 \) and \( t \in S_1 \).

By induction hypothesis,
- \( \#(S_1 \setminus \{ t \}) \leq r \implies f(I\cup \{ t \}) + f(I \cup S_1 \cup S_2) \leq f(I \cup S_1) + f(I \cup \{ t \} \cup S_2) \) and
- \( \#(S_2 \cup \{ t \}) \leq r \implies f(I) + f(I \cup \{ t \} \cup S_2) \leq f(I \cup \{ t \}) + f(I \cup S_2) \).

So we get \( f(I) + f(I\cup \{ t \}) + f(I\cup S_1 \cup S_2) \leq f(I\cup S_1) + f(I\cup \{ t \}) + f(I\cup S_2) \) which, after cancelling \( f(I + \{ t \}) \), becomes
\[ f(I) + f(I\cup S_1 \cup S_2) \leq f(I\cup S_1) + f(I\cup S_2). \]
#+end_proof

*** TODO Type B_n
 #+index: permutahedron ! type B

The calculation for the type B case is very similar to the type A case.
We start with \( \Perm^a(B_n) = \Set{ x \in \mathbb{R}^n }{ a_s x \leq b_s, s \in \SPowerset{n} \setminus \{ 0 \} } \), where \( a_s \defeq \sum_{i=1}^n s_ie_i^* \).
Let \( wa \) be the vertex corresponding to the simple system[fn:: see [[cite:humpreys90_reflection_groups][Section 2.10]]] \( -r_i = e_i - e_{i+1} \) for \( i \in [n-1] \) and \( -r_n = e_n \).
From this compute \( B_w = \Set{ S \in \SPowerset{[n]} \setminus \{ 0 \} }{ S = ([i],\emptyset), i \in [n] } \).
Again

\begin{equation*}
c_i \defeq (\tilde{B}^{-1}_w b|_{B_w}) =
\begin{cases}
b_{([1],\emptyset)}                         & \text{if } i = 1, \\
b_{([i],\emptyset)} - b_{([i-1],\emptyset)} & \text{if } 1 < i \leq n. \\
\end{cases}
\end{equation*}

For the opposite facets we get

\begin{alignat*}{4}
    a_{s(w,([i],\emptyset))([i],\emptyset)}
 =& a_{([i],\emptyset)} \circ s_{r_i}
&=& a_{([i-1]\cup \{ i+1 \},\emptyset)}
&=& \sum_{j=1}^{i-1} e_j^* + e_{i+1}^*,
& & \quad \text{for } i < n
 \\ a_{s(w,([n],\emptyset))([n],\emptyset)}
 =& a_{([n],\emptyset)} \circ s_{r_n}
&=& a_{([n-1],\{n\})}
&=& \sum_{j=1}^{n-1} e_j^* - e_n^*,
& & \quad \text{for } i=n
\end{alignat*}

And the inequalities are
\begin{alignat*}{3}
    b_{([i-1]\cup\{i+1\},\emptyset)} \geq
  & \sum_{j=1}^{i-1} c_i + c_{i+1}
&=& b_{([i-1],\emptyset)} + b_{([i+1],\emptyset)} - b_{([i],\emptyset)},
& & \quad \text{for } i < n 
 \\ b_{([n-1], \{n\})} \geq
  & \sum_{j=1}^{n-1} c_i - c_n
&=& b_{([n-1],\emptyset)} - b_{([n],\emptyset)} + b_{([n-1],\emptyset)},
& & \quad \text{for } i = n \\
\end{alignat*}

After applying the action of \( B_n = \{1,-1\}^n \rtimes S_n \), we obtain the /reduced bisubmodular inequalities/

#+begin_corollary
\begin{equation}
 \Perm^a(B_n) = \Set{ x \in \mathbb{R}^n }{ a_s x \leq b_s, s \in \SPowerset{n} \setminus \{ 0 \} } \label{eq:h-rep-type-b}
\end{equation}
is a deformation of the \( B_n \) permutahedron if and only if

\begin{equation}
b_{S\sqcup i} + b_{S\sqcup j} \geq b_S + b_{S\sqcup i \sqcup j }  \label{eq:bisubmodular1}
\end{equation}

for \( S \in \SPowerset{[n]} \setminus \{ \emptyset \} \) and \( I,J,|I|\neq|J| \) signed singleton subsets not contained in \( S \), i.e. \( \{ i \} = |I|, \{j\} = |J|, i\neq j \) and \( i,j \notin |S| \),
as well as

\begin{equation}
b_{(S_+ \cup \{i\},S_-)} + b_{(S_+,S_- \cup \{i\})} \geq 2b_S \label{eq:bisubmodular2}
\end{equation}

whenever \( S \in \SPowerset{[n]} \setminus \{ \emptyset \} \), \( \{ i \} = [n]\setminus |S| \).
#+end_corollary

As an application we can use this corollary to show that 
#+begin_corollary
/Signed simplices/
\[ D_s \defeq \ConvexHull\Set{0,s_ie_i }{ i\in [n]} \quad\text{ for } s \in \SPowerset{n} \setminus \{ 0 \} \]
are deformations of the \( B_n \) permutahedron.
#+end_corollary

#+begin_proof
Let \( s \in \SPowerset{n}\setminus \{ 0 \} \).
First we need to show that \( D_s \) admits an H-representation of the form \eqref{eq:h-rep-type-b} for some \( b \in \mathbb{R}^{\SPowerset{n} \setminus\{ 0 \}} \).

The lineality space of the normal cone is \( \Span\Set{e_i^* }{ i : s_i = 0} = \ConeHull\Set{ \pm a_{(\{i\},\emptyset)} }{ i : s_i = 0} \).
Furthermore each facet of \( D_s \) containing \( 0 \) is of the form \( D_t \) for a signed subset \( t \sqsubseteq s \), which differs from \( s \) in only one entry, say \( t_j = 0 \) whereas \( s_j \neq 0 \).
Then \( a_{-s_j(\{j\},\emptyset)} = -s_j e_j^* \) is facet-defining, because \( e_j^* D_t = 0 \) and \( -s_je_j^* s_je_j = -1 < 0 \).
The facet of \( D_s \) not containing \( 0 \) is \( \ConvexHull\Set{s_ie_i}{ i\in [n]} \) described by \( a_s \), as \( a_s \ConvexHull\Set{s_ie_i }{ i \in [n] } = 1 \) and \( a_s 0 < 1 \).
This proves that we indeed find a right-hand side \( b \).
In fact

\[ \forall t: b_t = \OneOrZero{t\sqcap s \neq 0} \]

defines the tight right-hand side. 
It remains to check the reduced bisubmodular inequalities. 
For \( T,I,J \in \SPowerset{[n]} \) and \( I,J \) atoms (i.e. \( \#|I| = \#|J| = 1 \)) we need to confirm:

\[ b_{t\sqcup i} + b_{t\sqcup j} \geq  b_t + b_{t\sqcup i \sqcup j} \]

Let \( S \) be the signed subset associated to the sign vector \( s \).
Note that the left and right side of the inequality take values in \( \{ 0,1,2 \} \).
If \( T\sqcap S = \emptyset \) and \( (T\sqcup I \sqcup J) \sqcap S = \emptyset \) then the right side of the inequality is 0.
If \( T\sqcap S = 0 \) and \( (T\sqcup I \sqcup J) \sqcap s \neq \emptyset \) then either \( I \sqsubseteq S \) or \( J \sqsubseteq S \), so the right side is \( 1 \) whereas the left side is either \( 2 \) or \( 1 \).
Finally if \( t\sqcap s \neq 0 \), then the left side is \( 2 \).

For \( T \) a coatom (meaning that \( \#([n]\setminus |T|) = 1 \)) and \( I \) an atom such that \( |I| \cup |T| = [n] \) we check that:
\[ b_{T\sqcup I} + b_{T\sqcup -I} \geq 2 b_T \]
If \( T\sqcap S = \emptyset \), then the right side evaluates to \( 0 \).
If \( T\sqcap S \neq \emptyset \), then both sides evaluate to \( 2 \).

The reduced bisubmodular inequalities hold, showing that \( D_s \) is indeed a deformation.
#+end_proof

#+begin_proposition
One can deduce the bisubmodular inequalities[fn::[[cite:fujishige05_submodular][Section 3.5.(b)]]]

\[ b_S + b_T \geq b_{S\sqcap T} + b_{S\sqcupplus T} \quad \text{ for all } S,T \in \SPowerset{[n]} \]

from the reduced ones, where the binary operation \( S\sqcupplus T \) is defined by

\[ S\sqcupplus T \defeq (S_+ \setminus T_- \cup T_+\setminus S_-, S_- \setminus T_+ \cup T_- \setminus S_+).\]
#+end_proposition

This \( \sqcupplus \) operation can also be interpreted as intersection of compositions[fn::See [[cite:bjorner99_oriented_matr][3.1]] for the definition of composition and more regarding signed subsets],  \( S \sqcupplus T = S\circ T \sqcap T\circ S \) and equals \( S\sqcup T \) whenever an upper bound of both \( S \) and \( T \) exists.
Even if an upper bound does not exist, \( S\sqcupplus T \sqsupseteq S\sqcap T \) holds, sometimes with equality.

#+begin_proof
The proof that bisubmodular inequalities follow from the reduced submodular inequalities is due to [[cite:ando1996characterization][Theorem 2]], which says that \( b \) satisfies the submodular inequalities if and only if \( b_S + b_T \geq b_{S\sqcap T} + b_{S\sqcupplus T} \)holds

- when \( S \sqcup T \) exists
- and also for \( S=(X_+\cup \{i\},X_-), T = (X_+,X_- \cup \{ i \}) \) for \( X \in \SPowerset{[n]}, i \in [n] \setminus |X| \).

The first case can be deduced from formula \eqref{eq:bisubmodular1} just like we did for submodular functions.
The second follows from the following calculation:
Let \( Z \defeq [n] \setminus (|X| \cup \{ i \}) \).
Then

\[ b_{(X_+\cup \{i\},X_-)} + b_{(X_+ \cup Z,X_-)} \geq b_X + b_{(X_+\cup \{i \} \cup Z, X_-)} \]

and similarly

\[ b_{(X_+,X_-\cup \{i\})} + b_{(X_+ \cup Z,X_-)} \geq b_X + b_{(X_+\cup Z, X_-\cup \{i\})} \]

which combines to

\begin{align*}
       & b_{(X_+\cup \{i\},X_-)} + b_{(X_+,X_-\cup \{i\})}  + 2 b_{(X_+ \cup Z,X_-)}
\\\geq & 2 b_X + b_{(X_+\cup \{i \} \cup Z, X_-)} + b_{(X_+\cup Z, X_-\cup \{i\})}
\\\geq & 2 b_X + 2b_{(X_+\cup Z,X_-)}
\end{align*}

noting that the second inequality comes from formula \eqref{eq:bisubmodular2}.
Cancellation of \( 2 b_{(X_+ \cup Z,X_-)} \) finally yields

\[ b_{(X_+\cup \{i\},X_-)} + b_{(X_+,X_-\cup \{i\})}  + \geq 2 b_X \]
#+end_proof

#+begin_remark
The Q-polytopes considered by [[cite:ardila08_matroid_polyt_their_volum][Section 3]] are deformations of the \( B_n \) permutahedron.
#+end_remark

*** TODO Type D_n                                            :draft:noexport:
 #+index: permutahedron ! type D

\( D_n = \{ 1, -1\}^{n-1} \rtimes S_n \).

- roots and reflections ::
  \begin{alignat*}{2}
  -r_i =& e_i - e_{i+1} && (i<n) \\
   s_{r_i} =& (i, i+1) \in D_n && \\
  -r_n =& e_{n-1} + e_n && \\
   s_{r_n} =& (\overline{n}, \overline{n-1})&&
  \end{alignat*}
- facets at \( wa \) ::
  \begin{alignat*}{2}
  a_i     =& \sum_{j=1}^i e_j^*             && (i \neq n-1) \\
  a_{n-1} =& \sum_{j=1}^{n-1} e_j^* - e_n^* &&
  \end{alignat*}
- opposite facets ::
  \begin{alignat*}{2}
  a'_i     &= a_i \circ s_{r_i}         &=& \sum_{j=1}^{i-1} e_j^* + e_{i+1}^*, \quad (i \leq n-2) \\
  a'_{n-1} &= a_{n-1} \circ s_{r_{n-1}} &=& \sum_{j=1}^{n-2} e_j^* - e_{n-1}^* + e_n^* \\
  a'_n     &= a_n \circ s_{r_n}         &=& \sum_{j=1}^{n-2} e_j^* - e_{n-1}^* - e_n^* \\
  \end{alignat*}
- inverse \( c = \tilde{B}_w^{-1} \) ::
     
  \begin{alignat*}{3}
  b_i     =& a_i c     &=& \sum_{j=1}^i c_j           && (i \neq n-1) \\
  b_{n-1} =& a_{n-1} c &=& \sum_{j=1}^{n-1} c_j - c_n &&
  \end{alignat*}

  holds if and only if

  \begin{alignat*}{2}
  c_1     =& b_1                                  && \\
  c_i     =& b_i - b_{i-1}                        && (2 \leq i \leq n-2) \\
  c_{n-1} =& \frac{1}{2}(b_n + b_{n-1}) - b_{n-2} && \\
  c_n     =& \frac{1}{2}(b_n + b_{n-1})           &&
  \end{alignat*}
- (asymmetric) inequalities ::

  \begin{alignat*}{4}
  b'_i     \geq& a'_i c     &=& \sum_{j=i}^{i-1} c_j + c_{i+1}
                            &=& b_{i-1} + b_{i+1} - b_i
                            && \quad (i \leq n-3) \\
  b'_{n-2} \geq& a'_{n-1} c &=& \sum_{j=i}^{n-3} c_j + c_{n-1}
                            &=& b_{n-3} + \frac{1}{2}b_n - \frac{1}{2}b_{n-1} - b_{n-2}
                            && \\
  b'_{n-1} \geq& a'_{n-1} c &=& \sum_{j=i}^{n-2} c_j - c_{n-1} + c_n
                            &=& 2b_{n-2} - b_{n-1}
                            && \\
  b'_n     \geq& a'_{n-1} c &=& \sum_{j=i}^{n-2} c_j - c_{n-1} - c_n
                            &=& 2b_{n-2} - b_n
                            && \\
  \end{alignat*}

** Nice polytope bases for deformations in type A and B            :noexport:
*** Introduction
The dimension of the deformation cone of a polytope \( P \) is finite, which can be confirmed by looking at the isomorphic descriptions we have given so far.
The functoriality of the linear completion construction yields a linear isomorphism \( \mathbb{R}\DefCone_P \to \Span(\FacetCone_P) \).
Because \( \DefCone_P \) is full-dimensional in \( \mathbb{R}\DefCone_P \) there exists a basis \( \mathcal B \) of \( \dim \DefCone_P \) polytopes in \( \DefCone_P \) in whose terms we can describe the map \( \mathbb{R}\DefCone_P \to \Span(\FacetCone_P) \).
In other words, we can write all deformations as linear combinations of polytopes in the basis \( \mathcal B \), and we can give the isomorphism \( \DefCone_P \to \FacetCone_P \) of abstract cones as restriction of the linear isomorphism \( \mathbb{R}\DefCone_P \to \Span(\FacetCone_P) \).

*** Type A_{n-1}
#+index: permutahedron ! type A
A well-known basis of the type \( A_{n-1} \)-permutahedron ([[cite:postnikov05_permut_assoc_beyon][Proposition 6.3]], [[cite:ardila08_matroid_polyt_their_volum][Proposition 2.4]]) is given by the coordinate simplex and its faces, which we have seen in \ref{sec:example-simplex}:
\[ \Delta_I \defeq \ConvexHull\Set{ e_i }{ i \in I } \quad \text{ for } \emptyset \subsetneq I \subseteq [n] \]

Taking the H-representation of \( \Perm^a(A_{n-1}) \) to be
\[ \Perm^a(B_n) = \Set{ x \in \mathbb{R}^n }{ \sum_{i=1}^n x_i = z_{[n]}, \sum_{i \in J} x_i \leq z_i, (\emptyset \subsetneq J \subsetneq [n]) }. \]

We can write down the isomorphism

\begin{alignat*}{2}
  & \DefCone_{\Perm^a(A_{n-1})} &\to& \FacetCone_{\Perm^a(A_{n-1})}
\\& \sum_{\emptyset \subsetneq I \subseteq [n]} y_I \Delta_I &\mapsto& \{ z_I \defeq \sum_{\emptyset \subsetneq J \subseteq I} y_J\}
\end{alignat*}

After setting \( y_\emptyset = z_\emptyset = 0 \) this map can be recognised as convolution product of the function \( z : \Powerset{[n]} \to \mathbb{R} \) by an element of the incidence algebra \( 1 \in I(\Powerset{[n]}) \) over the Boolean lattice \( \Powerset{[n]} \).
Thus the inverse is given by the Möbius inversion formula on \( \Powerset{[n]} \):
\[ y_I = \sum_{J\subseteq I} (-1)^{\# I - \# J} z_J \]
For an explanation of the incidence algebra and the Möbius inversion formula we refer to the appendix, section \ref{appendix:mobius-inversion}  or cite:rota64_mobius_func.

*** Type B_n
 #+index: permutahedron ! type B
**** An inversion formula and signed simplices

In this section we want to study the endomorphism \( A_n \in \End(\mathbb{R}^{\SPowerset{n}}) \) is defined by

\[ (A_nf)(s) \defeq \sum_{t: t\sqcap s \neq 0} f(t) \qquad  (f : \SPowerset{n} \to \mathbb{R}) \]

\( A \) does not admit an inverse, but its restriction to \( \mathbb{R}^{\SPowerset{n}\setminus \{ 0 \}} \) turns out to do.
In order to write \( A \) as a matrix we must choose a total order on \( \SPowerset{n} \) and we choose the lexicographical order, where \( 0 < + < - \).
This gives a total order on the standard basis \( e_s, s \in \SPowerset{n} \),
\[ e_s(t) \defeq \OneOrZero{s = t}. \]

The matrix \( A \) satisfies the recursion formula
\[ A_0 = 0, \quad A_{n+1} = \begin{pmatrix} A_n & A_n & A_n \\
A_n & U & A_n \\ A_n & A_n &  U \end{pmatrix} \]
where \( U \) is the square matrix (of appropriate dimension) consisting solely of \( 1 \)s.
This recursion holds, because for \( s = (s_1,s'), t=(t_1,t'), (t',s' \in \SPowerset{n-1}) \) we have \( s \sqcap t \neq 0 \) if and only if \( s_1=t_1=1 \) or \( s_1=t_1=-1 \) or \( s' \sqcap t' \neq 0 \).

Restricting \( A_n \) to \( \SPowerset{n} \setminus \{ 0 \} \) means dropping the first row and the first column.
Denote the so obtained matrix by \( A'_n \).
Note that \( \det(A'_1) = 1 \).
By Gaussian elimination
\[ \det(A'_{n+1})
  = \det\begin{pmatrix} A'_n & * & * \\ 0 & U-A_n & 0 \\ 0 & 0 &  U-A_n \end{pmatrix}
  = \det(A'_n)\det(U-A_n)^2 \]

On the other hand
\begin{align*}
\det(U-A_{n+1})
  =& \det\begin{pmatrix} U-A_n & U - A_n & U-A_n \\ U-A_n & 0 & U-A_n \\ U-A_n & U-A_n & 0  \end{pmatrix}
\\=& \det\begin{pmatrix} U-A_n & U - A_n & U-A_n \\ 0 & A_n - U & 0 \\ 0 & 0 & A_n - U \end{pmatrix}
= \det(U-A_n)^3
\end{align*}

and \( U-A_0 = 1 \), so \( \det(U-A_n) = 1 \) for all \( n \).
So \( \det(A'_{n+1}) = \det(A'_n) \) and by induction all \( A_n \) are invertible over the integers.
Naturally we want to give an inverse.
Computing examples for smaller \( n \), one observes that the inverse of \( A'_n \) admits some fractal patters as well, which we capture in the following definition:
\[ B_0 = 1, \quad B_{n+1} = \begin{pmatrix} B_n & -B_n & -B_n \\ -B_n & B_n & 0 \\ -B_n & 0 & B_n \end{pmatrix}. \]

- 1^{st} claim :: The first column of \( UB_n \) consists only of entries \( (-1)^n \), and all the other entries are \( 0 \).

We prove this by induction: The claim is obviously true for \( n = 0 \).
We compute
\[ UB_{n+1} = \begin{pmatrix}
-UB_n & 0 & 0 \\
-UB_n & 0 & 0 \\
-UB_n & 0 & 0
\end{pmatrix} \]
whose first column consists of entries \( -(-1)^n = (-1)^{n+1} \) by induction hypothesis and otherwise has entries \( 0 \).
\( \blacksquare \)

- 2^{nd} claim :: \[ A_nB_n = \begin{pmatrix} 0 & 0 \\ (-1)^n & \\ \vdots & (-1)^{n+1}I_{3^n-1} \\ (-1)^n & \end{pmatrix} \] where \( I_{3^n-1} \) is the \( (3^n-1)\times(3^n-1) \) identity matrix.

The claim holds for \( n = 0 \) and \( n = 1 \) (this is just a computation).
Now consider
\[ A_{n+1}B_{n+1} = \begin{pmatrix}
-A_nB_n & 0 & 0 \\
-UB_n & UB_n - A_nB_n & 0 \\
-UB_n & 0 &  UB_n - A_nB_n
\end{pmatrix} \]

Now the identity \( UB_n - A_nB_n = (-1)^nI_{3^n-1} \) together with the first claim are enough to show that \( A_{n+1}B_{n+1} \) is of the desired form.
\( \blacksquare \)

Let \( B'_n \) be the matrix \( B_n \) with first column and row dropped.
From the second claim we obtain the relation \( B'_n = (-1)^{n+1}(A'_n)^{-1} \),
and the explicit description
\[ (B_nf)(s) = \sum_{t:\exists t\sqcup s} (-1)^{m'(s,t)} f(t) \]
with \( m'(s,t) = \#\Set{i }{ s_i \neq t_i } \).
For convenience we also define \( m(s,t) = 1 + n - m'(s,t) = 1 + \#\Set{ i }{ s_i = t_i } \).
Altogether we obtain the following inversion formula:

#+begin_theorem
Given \( f,g \in \mathbb{R}^{\SPowerset{n}\setminus\{0\}} \) satisfying \( f(s) = \sum_{t: t\sqcap s \neq 0} g(t) \), we can recover 
\( g(s) = \sum_{t: \exists t\sqcup s} (-1)^{m(s,t)} f(t) \)
#+end_theorem

#+begin_remark
The matrix \( A'_n \) is symmetric, so there is no hope in finding a partial order on \( \SPowerset{n} \) such that the inversion formula becomes Möbius inversion.
#+end_remark

Finally we should explain the connection to deformation cones:
The signed simplices

\[ D_s \defeq \ConvexHull\Set{0,s_ie_i }{ i \in [n]} \quad (s \in \SPowerset{n}\setminus \{0\}) \]

are rigid and generate a full-dimensional subcone of the deformation cone of \( \Perm^a(B_n) \).
The matrix defining the facets of the \( B_n \)-permutahedron has \( 3^n-1 \) row vectors \( t \in \{0,1,-1\}^n \setminus \{ 0 \} \simeq \SPowerset{n} \setminus \{ 0 \} \).
By abuse of notation we identify the sets \( \{ 0,-1,-1\}^n \) and \( \SPowerset{n} \) via the bijection induced by \( \sign : \mathbb{R}^n \to \SPowerset{n} \).
The right-hand side vector \( b \) for \( D_s \) is therefore given by \( b_t = \max \inner{t,D_s} = \OneOrZero{t\sqcap s \neq 0} \).
Thus \( b \) is the \( s \)-column of \( A'_n \).

#+begin_corollary
Every deformation \( P \) of \( \Perm^a(B_n) \) can be written as linear combination \( \sum_{s \in \SPowerset{n} \setminus\{0\}} y_s D_s \).
\( A'_n \) establishes an isomorphism from \( \DefCone_{\Perm^a(B_n)} \) to \( \FacetCone_{\Perm^a(B_n)} \) by sending the coordinates \( \{y_s\} \) to the right-hand side vector \( \{ z_s \}_{s \in \SPowerset{n} \setminus\{0\}} \) for the system of linear inequalities describing \( P \).
#+end_corollary

#+begin_proof
The columns of \( A'_n \) form a basis and are furthermore the right-hand sides of the signed simplices \( D_s \).
Therefore \( \Set{ D_s }{ s \in \SPowerset{n} \setminus \{ 0 \}} \) is a linearly independent subset in \( \mathbb{R}\DefCone_{\Perm^a(B_n)} \) of cardinality \( 3^n-1 \).
The dimension of \( \DefCone_{\Perm^a(B_n)} \) equals the dimension of \( \FacetCone_{\Perm^a(B_n)} = 3^n-1 \), so we in fact have a basis of \( \mathbb{R}\DefCone_{\Perm^a(B_n)} \) at our hands. 
#+end_proof

#+begin_corollary
Q-polytopes cite:ardila08_matroid_polyt_their_volum are summands of a \( B_n \)-permutahedron.
#+end_corollary
**** Writing the simplex \( \Delta_I \) in terms of signed simplices \( D_s \)

  #+begin_lemma
  If \( S \) is a non-empty finite set, then the number of even subsets of \( S \) equals the number of odd subsets of \( S \)
  #+end_lemma
  #+begin_proof
  This is just a consequence of the  well-known identity \( \sum_{i=0}^{\#S} (-1)^i\binom{\#S}{i} = 0 \), which holds as \( \#S \geq 1 \).
  #+end_proof


  #+begin_proposition
  Let \( I \) be a non-empty subset of \( [n] \).
  Then
  \[ \Delta_I = D_{(I,\emptyset)} + \sum_{\emptyset \subsetneq J \subseteq I} (-1)^{\#J} D_{(\emptyset,J)} \]
  #+end_proposition

  #+begin_proof

  The roots of \( A_{n-1} \) are roots of \( B_n \), so \( \Perm^a(A_{n-1}) \) and thus all \( \Delta_I \) are summands of \( \Perm^a(B_n) \).
  Therefore the outer normals of \( \Perm^a(B_n) \) are enough to give an H-representation of \( \Delta_I \) and we have to show that \( \inner{t,-}, t \in \{0,1,-1\}^n \) attains the same maximal value on \( \Delta_I \) as it does on \(D_{(I,\emptyset)} + \sum_{\emptyset \subsetneq J \subseteq I} (-1)^{\#J} D_{(\emptyset,J)} \).

  Define \( I_- \defeq \Set{ i \in I }{ t_i = -1 } \) and \( I^c_- = I \setminus I_- \).
  Write \( e(J) \) for the number of even subsets of \( J \), \( o(J) \) for the number of odd subsets of \( J \).

  Then

  \begin{align*}
     & \max \inner{t,\sum_{\emptyset \subsetneq J \subseteq I} (-1)^{\#J} D_{(\emptyset,J)}}
  \\=& \#\Set{ J \subseteq I }{ \#J \text{ even}, J\cap I_- \neq \emptyset } - \#\Set{J \subseteq I }{ \#J \text{ odd}, J\cap I_- \neq \emptyset }
  \\=& e(I^c_-)(e(I_-)-1) + o(I^c_-)o(I_-) - e(I^c_-)o(I_-) - o(I^c_-)(e(I_-)-1)
  \\\defeq& (\star)
  \end{align*}

  - case \( I_- \neq \emptyset \neq I^c_- \): ::
    Note that \( o(I^c_-) = e(I^c_-) \defeq C_1, e(I_-) = o(I_-) \defeq C_2 \) by the lemma, and therefore
    \( (\star) = C_1(C_2-1) + C_1C_2 - C_1C_2 - C_1(C_2-1) = 0 \).
  - case \( I_- = I, I^c_- = \emptyset \): ::
    \( o(I^c_-) = 0, e(I^c_-) = 1 \) and \( o(I_-) = e(I_-) \defeq C \)  by the lemma.
    Thus \( (\star) = 1(C-1) + 0C - 1C - 0(C-1) = -1 \).
  - case \( I_- = \emptyset, I^c_- = I \): ::
    \( o(I_-) = 0, e(I_-) = 1 \) and \( o(I^c_-) = e(I^c_-) \defeq C \)  by the lemma.
    So \( (\star) = C(1-1) + C0 - C0 - C(1-1) = 0 \).

  Finally we obtain
  \[
  \max \inner{t,D_{(I,\emptyset)} + \sum_{\emptyset \subsetneq J \subseteq I} (-1)^{\#J} D_{(\emptyset,J)}}
  = \begin{cases}
          1,& \exists i \in I: t_i = 1
      \\ -1,&  I_- = I
      \\  0,&  \text{ otherwise}
     \end{cases}
  \\= \max_{i\in I} t_i = \max \inner{t,\Delta_I}
  \]

  #+end_proof
 
  #+begin_remark
 It may seem that the calculation presupposes the existence of
\[ \sum_{\emptyset \subsetneq J \subseteq I} (-1)^{\#J} D_{(\emptyset,J)}, \]
 which is a Minkowski difference.
 This can be remedied by noting that the equation \( P + Q = R \) holds for polytopes if and only if \( \max uP = \max uR - \max uQ \) for every functional \( u \), in which case \( R - Q \) is automatically defined and equals \( P \).
 #+end_remark
*** Application: linear programming                                   :draft:
Given a deformation \( P \) of \( \Perm^a(A_{n-1}) \) given by \( \{ z_I \} \in \FacetCone_P \) we can find the maximum value of a functional \( c = \sum_{i=1}^n c_i e_i^* \) of \( P \) by the formula
\[ \max_{x \in P} cx
= \sum_{\emptyset \subsetneq I\subseteq [n]} y_I \max_{x\in \Delta_I} cx
= \sum_{\emptyset \subsetneq I\subseteq [n]} y_I \max_{i\in I} c_i
\]
*** Application: mixed volumes                               :draft:noexport:
#+index: mixed volumes
* Appendix
** Incidence algebra and the Möbius inversion formula
\label{appendix:mobius-inversion}
In this section I describe Rota's Möbius inversion formula, see cite:rota64_mobius_func.

Let \( R \) be a ring (usually \( R = \mathbb{R} \)) and let \( (S,\leq) \) be a locally finite[fn::i.e. \( S \) has finite intervals \( [x,y] \defeq \Set{ s \in S }{ x \leq s \leq y } \)] partially ordered set.
Then we can define an \(R\)-algebra structure on the set \( I(S) \defeq R^{|\leq|} \) of functions on the relation \( |\leq| \defeq \Set{ (a,b) \in S\times S }{ a \leq b } \).
This algebra goes by the name /incidence algebra/.
#+index: incidence algebra
#+index: \( I(S), I(\Powerset{[n]} \)
The addition is simply pointwise and the multiplication is given by the convolution product \( * \): For \( f,g \in I(S) \) set
\[ (f*g)(a,c) = \sum_{a\leq b \leq c} f(a,b)g(b,c) \]
Note that the sum is finite due to the finiteness of intervals.
The left and right identity of this multiplication can easily be verified to be \( \delta(a,b) = \delta_{a,b} \) where the latter delta is Kronecker's delta.
Furthermore we can define \( u \in I(S), u(a) = 1\, \forall a \in S \) which admits a multiplicative inverse, called the Möbius function of \( S \).
The Möbius function exists and a recursive formula is readily deduced from its definition \( \mu * u = \delta \):
\[ \mu(a,c) = \delta_{a,b} - \sum_{a\leq b < c} \mu(a,b) \]
This shows the existence of a left-inverse and similarly we can define the right-inverse, so \( \mu \) is in fact the unique left- and right-inverse.

Now assume that \( S \) has finite downsets \( \Set{ s \in S }{ s \leq x } \) for \( x \in S \).
Having finite downsets implies having finite intervals, so \( I(S) \) is well-defined and the following definition makes sense:
The set of functions \( R^S \) is a right \( I(S) \)-module with multiplication
\[ f*g(b) = \sum_{b \leq a} f(b)g(a,b) \]
for \( f \in R^S, g \in I(S) \).
In particular we have

#+begin_theorem [Möbius inversion formula]
#+index: Möbius inversion formula
Let \( R \) be a ring and \( (S,\leq) \) be a partially ordered set with finite downsets.
Furthermore let \( g \in R^S \) and \( f(b) = \sum_{a\leq b} g(a) \).
Then \( g(c) = \sum_{b \leq c} f(b)\mu(b,c) \).
#+end_theorem
#+begin_proof
\( f = g*u \) and thus \( g = g*\delta = g*u*\mu = f*\mu \).
#+end_proof

Examples:
- For the powerset \( S = (\Powerset{M},\subseteq) \) of a set \( M \) ordered by inclusion we obtain \( \mu(A,B) = (-1)^{\#A - \# B} \) whenever \( A \subseteq B \subseteq M \).
- For the natural numbers \( (\mathbb{N},|) \) ordered by divisibility the Möbius function takes the form
  \[ \mu(n) = \begin{cases} (-1)^r & \text{ if \( n \) is square-free product of \( r \) primes} \\ 0 & \text{ otherwise } \end{cases} \]
- For the chain \( [n] \) the value of \( \mu(i,j) \) is \( 1 \) if \( i = j \), \( -1 \) if \( i=j-1 \) and \( 0 \) otherwise.
** The vector space of an abstract cone
\label{appendix:vector-space-of-cone}
*** Grothendieck group completion
:NOTES:
- need some references :)
:END:
 For a given commutative monoid \( M \) we want to find the "least" group, which contains \( M \).
 #+index: commutative monoid
 More precisely, we wish to find an Abelian group \( G(M) \) together with a map \( \theta_M : M \to G(M) \) of monoids, such that every other map \( M \to G' \) into an Abelian group factors uniquely as \( M \overset{\theta_M}\to G(M) \to G' \).
 An Abelian group \( G(M) \) satisfying this universal property is a /group completion/ of \( M \) and it is unique up to group isomorphism.
 #+index: group completion
 #+index: group completion ! universal property
 In even fancier language the assignment \( M \mapsto G(M) \) together with the factorisation property determines the left-adjoint functor of the forgetful functor \( \AbelianGroups \to \AbelianMonoids \) from the category of Abelian groups into the category of commutative monoids.
 #+index: \( \AbelianGroups \)
 #+index: \( \AbelianMonoids \)



 #+begin_theorem
 [Grothendieck group completion]
 \label{thm:group-completion}
 #+index: group completion ! Grothendieck

 Given a commutative monoid \( M \), we can define the /Grothendieck group completion/ \( G(M) \) as quotient of \( M\times M \) by the equivalence relation \( (m,n) \sim (m',n') \Leftrightarrow \exists k\in M:\, m+n'+k = m'+n+k \).
 #+index: group completion ! Grothendieck
 The addition on \( G(M) \) defined on the representatives \( (m,n) + (m',n') \defeq (m+m',n+n') \) gives \( G(M) \) the structure of an Abelian group with neutral element \( (0,0) \).

 Furthermore \( G(M) \) can be considered a group completion given \( \theta_M : M \to G(M), m \mapsto (m,0) \).
 If \( M \) has the cancellation property, i.e. \(m+r = m'+r \implies m=m'\) for all \( m,m',r \in M \), then \( \theta_M \) is injective and \( M \) can be considered as a subset of \( G(M) \).
 #+index: cancellation property
 #+end_theorem

 #+begin_proof
 The relation \( \sim \) is obviously symmetric and reflexive.
 For transitivity suppose that \( k_1 \) witnesses \( (m,n) \sim (m',n') \) and \( k_2 \) witnesses \( (m',n') \sim (m'',n'') \).
 So

 \begin{align*}
 m+(m'+n''+k_2)+k_1
   &= m+(m''+n'+k_2)+k_1
 \\&= m''+(m+n'+k_1)+k_2
 \\&= m''+(m'+n+k_1)+k_2
 \end{align*}

 Thus \( m+n'' + (m'+k_1+k_2) = m''+n + (m'+k_1+k_2) \), so \( (m,n) \sim (m'',n'') \) and \( \sim \) is indeed an equivalence relation.

 If \( (m,n) \sim (m'',n'') \), then there exists a \( k \in M \) such that \( m + n'' + k = m'' + n + k \).
 Hence, for any \( (m',n') \in M\times M \) we have \( m'' + m' + n + n' + k = m + m' + n'' + n' + k \), which shows \( (m+m',n+n') \sim (m''+m',n''+n') \).
 This implies well-definedness of the addition.
 Associativity and commutativity of this addition can be checked componentwise and follow from the associativity and commutativity of the addition on \( M \).
 That the equivalence class of \( (0,0) \) is a neutral element with respect to this addition is follows from \( (m+0)+n = m+n = m+(n+0) \).
 Finally the inverse element to \( (m,n) \) is \( (n,m) \), as \( (m+n,n+m) \sim (0,0) \).

 For the inclusion \( \theta_M \), we have \( \theta_M(0) = (0,0) \) and \( \theta_M(m+m') = (m+m',0) = (m,0) + (m',0) \), so it is a homomorphism of monoids.
 Suppose we are given a homomorphism \( \phi : M \to G' \) into an Abelian group.
 Then we may define \( \phi' : G(M) \to G' \) via \( (m,n) \mapsto \phi(m)-\phi(n) \).
 Again, this is well-defined: If, for some \( k \in M \), \( m''+n+k = m+n''+k \),
 then \( \phi(m'') - \phi(n'') + \phi(k) = \phi(m) - \phi(n) + \phi(k) =  \) and we may cancel \( \phi(k) \).
 Clearly \( \phi = \phi' \circ \theta_M \).
 Now, if we're given another \( \psi : G(M) \to G' \) with

 \[ M \overset{\theta_M}\to  G(M) \overset\psi\to G' = M \overset{\phi}\to G' \]

 Then \( \psi((0,n)) = -\psi((n,0)) = \phi(n) \) and therefore \( \psi(m,n) = \psi((m,0)+(0,n)) = \psi((m,0))-\psi((n,0)) = \phi(m)-\phi(n) = \phi'((m,n)) \).
 Hence \( \phi' \) is unique.


 If \( M \) has the cancellation property, then \( (m,0) = (m',0) \) implies \( m+k = m'+k \) for some \( k \in M \) and cancellation gives \( m = m' \), establishing injectivity of \( \theta_M \).
 #+end_proof

*** Linear completion
#+index: abstract cone ! linear completion
#+index: linear completion \see{abstract cone}
In the spirit of the group completion of a commutative monoid, we construct in this section the vector space completion, or /linear completion/ in short, of an abstract cone.

#+begin_lemma
\label{thm:linear-completion}
Let \( C \) be an abstract cone, then the Grothendieck group completion \( G(C) \) together with scalar multiplication given by
\[ \lambda (p,q) = \begin{cases} (\lambda p, \lambda q) & \text{ if } \lambda \geq 0 \\ (-\lambda q, -\lambda p) & \text{ if } \lambda < 0 \end{cases} \]
is a vector space, called the /linear completion/.
To make clear that we view \( G(C) \) as a vector space, we denote it by \( \mathbb{R}C \).
#+end_lemma

#+begin_proof
By Theorem \ref{thm:group-completion} \( G(C) \) is an Abelian group.
It remains to verify the laws of scalar multiplication, which is a tedious calculation.

The identity \( 1  (p,q) \defeq (1p,1q) = (p,q) \) is straight forward.

\( \lambda(\mu(p,q)) = (\lambda\mu)(p,q) \)
can be done by considering the four cases \( \lambda \geq 0 \meet \mu \geq 0, \lambda \geq 0 \meet \mu < 0, \lambda < 0 \meet \mu \geq 0\) and \( \lambda < 0 \meet \mu < 0 \).

\( \lambda ((p,q)+ (p',q')) = \lambda (p,q) + \lambda  (p',q') \)
can be calculated by case analysis as well with cases \( \lambda \geq 0 \) and \( \lambda < 0 \).

The last identity
\[  (\lambda+\mu) (p,q) = \lambda   (p,q) + \mu   (p,q) \]
involves four cases \( \lambda \geq 0 \meet \mu \geq 0, \lambda < 0 \meet \mu < 0, \lambda \geq 0 \meet \mu < 0 \meet \lambda + \mu \geq 0 \) and \( \lambda \geq 0 \meet \mu < 0 \meet \lambda + \mu < 0 \) only as we can get rid of two cases by using the commutativity of \( + \).
The first two cases are again easy and the last two require a trick, but they are similar.
So we only give a calculation for the third case.

Note that \( \left(\lambda p + (-\mu)q , \lambda q + (-\mu)p\right)  = \left((\lambda+\mu)p , (\lambda+\mu)q\right) \), as
\[ (\lambda +\mu) p + \lambda q + (-\mu)p = \lambda p + \lambda q = \lambda p + (\lambda+\mu)q + (-\mu)q.\]
Hence
\begin{align*}
   (\lambda+\mu)(p,q)
   &= ((\lambda+\mu)p , (\lambda +\mu) q)
\\ &= (\lambda p + (-\mu)q , \lambda q + (-\mu)p)
\\ &= (\lambda p , \lambda q) + ((-\mu)q , (-\mu)p)
\\ &= \lambda (p,q) + \mu (p,q)
\end{align*}
#+end_proof

#+begin_theorem
The inclusion \( \theta_C : C \hookrightarrow \mathbb{R}C, c \mapsto (c,0) \) satisfies the /universal property of linear completion/:
#+index: linear completion ! universal property
If \( E \) is a vector space and \( \phi : C \to E \) is a morphism of abstract cones, then there exists a unique linear map \( \phi' : \mathbb{R}C \mapsto E \) such that \( \phi = \phi' \circ \theta_C \).
It is given by
\[ \phi'(c_1,c_2) = \phi(c_1) - \phi(c_2). \]
#+end_theorem

#+begin_proof
Injectivity of \( \theta_C \) is due to the cancellation property of abstract cones and Theorem \ref{thm:group-completion}.
Let \( (p,q) = (p',q') \in \mathbb{R}C \) meaning \( p+q' = p'+q \).
Then \( \phi(p) + \phi(q') = \phi(p+q') = \phi(p'+q) = \phi(p')+\phi(q) \), so \( \phi(p)-\phi(q) = \phi(p') - \phi(q') \).
Therefore \( \phi'(p,q) = \phi(p)-\phi(q) = \phi(p') - \phi(q') = \phi'(p',q') \) holds and \( \phi' \) is a well-defined function.
Linearity follows from
\begin{align*}
\phi'((p,q)+\lambda(p',q'))
=& \begin{cases}
  \phi'(p+\lambda p', q+\lambda q') & \text{ if } \lambda \geq 0 \\
  \phi'(p-\lambda q', q-\lambda p') & \text{ if } \lambda < 0
  \end{cases}
\\=& \begin{cases}
  \phi(p)+ \lambda\phi(p')- \phi(q)- \lambda \phi(q') & \text{ if } \lambda \geq 0 \\
  \phi'(p) + (-\lambda)\phi(q')- \phi(q)-(-\lambda)\phi( p') & \text{ if } \lambda < 0
  \end{cases}
\\=& \phi(p)+ \lambda\phi(p') - \phi(q) - \lambda \phi(q')
\\=& \phi'(p,q)+\lambda \phi'(p',q')
\end{align*}
Uniqueness of \( \phi \) is clear: If \( \phi = \psi\circ\theta_C \), then \( \psi(0,q) = \psi(-(q,0)) = -\phi(q) \), so \( \psi(p,q) = \psi(p,0) + \psi(0,q) = \phi(p)-\phi(q) \).
#+end_proof

** Virtual polytopes
*** Virtual polytopes via linear completion
\label{appendix:virtual-polytopes}

The space of polytopes \( \Polytopes(\mathbb{R}^n) \) is an abstract cone with Minkowski summation \( P+Q = \Set{x+y}{x\in P,  y\in Q} \) as addition and central dilation \( \lambda P = \Set{\lambda x}{x\in P} \) as scalar multiplication.
It is not too hard to check the compatibility laws for the scalar multiplication, so we will only give the proof for the cancellation law.

#+begin_lemma
\( \Polytopes(\mathbb{R}^n) \) is a commutative monoid with cancellation.
#+end_lemma

#+begin_proof
Minkowski summation is clearly associative and commutative, with neutral element \( \{ 0 \} \).
To show the cancellation property assume that \( P,Q,Q' \) are polytopes and \( Q \neq Q' \), which means that for some functional \( c : \mathbb{R}^n \to \mathbb{R} \) we have \( \max_{x\in Q} cx \neq \max_{x\in Q'} cx \).
But then

\[ \max_{x\in P+Q} cx = \max_{x\in P} cx + \max_{x\in Q} cx \neq \max_{x\in P} cx + \max_{x\in Q'} cx = \max_{x\in P+Q'} cx, \]

so \( P+Q \neq P+Q' \), as desired.
#+end_proof

As an abstract cone, \( \Polytopes(\mathbb{R}^n) \) can be embedded into its (Grothendieck) linear completion \( \mathbb{R}\Polytopes(\mathbb{R}^n) \defeq \VirtualPolytopes(\mathbb{R}^n) \), the set of /virtual polytopes/.
#+index: \( \VirtualPolytopes \) \see{virtual polytope}
#+index: virtual polytope
A different way to construct the linear completion of \( \Polytopes(\mathbb{R}^n) \) is via generalised support functions, which we will describe in the next section.

*** Virtual polytopes via support functions                           :draft:
A polytope can be described as the solution set for a system of inequalities, towards which our attention will shift in this section.
Instead of using a finite number of linear inequalities we want to consider all inequalities defining a polytope \( P \), which leads us to the definition of the /support function/ \( f_P : \mathbb{R}^{n*} \to \mathbb{R} \) of \( P \):
#+index: support function
\[ f_P(c) \defeq \max_{x\in P} c(x) = \max_{x\in P} x^{**}(c) \]
The idea to study such support functions goes back to Minkowski, see [[cite:oda85_convex_bodies][section A.3]] or [[cite:rockafellar1983generalized][Section 3]].
A generalised construction occurs in the context of virtual polytopes cite:pukhlikov1993finitely.
If \( P \) consists of a single point \( x \), then \( f_P = x^{**} \).
Functions \( f : \mathbb{R}^{n*} \to \mathbb{R} \) which arise as support function \( f_P \) for some polytope \( P \) are called /polytopal/ and functions \( f \) such that \( -f \) is polytopal are called /antipolytopal/.
#+index: support function ! polytopal
#+index: support function ! antipolytopal
Elements of \( \mathbb{R}^{n**} \) are both polytopal and antipolytopal.
The set of /generalised support functions/ \( \GeneralisedSupportFunction(n) \) is the vector space spanned by the support functions in \( \mathbb{R}^{\mathbb{R}^{n*}} \) so it contains the polytopal and antipolytopal functions, each as subcone.
#+index: generalised support function
#+index: support function ! generalised
Note that addition and scalar multiplication correspond, in the cone of polytopal functions, to Minkowski summation and central dilation.
Generalised support functions are precisely those of the form \( f + g \) where \( f \) is polytopal and \( g \) is antipolytopal.
\( \mathbb{R}^{\mathbb{R}^{n*}} \) admits a lattice structure by taking as meet the pointwise minimum \( (f \meet g)(c) = \min(f(c),g(c)) \) and taking as join the pointwise maximum \( (f\join g)(c) = \max(f(c),g(c)) \).
It can be easily verified that we have associativity laws \( f+(g\meet h) = (f+g) \meet (f+h) \) as well as \( f+(g\join h) = (f+g) \join (f+h) \) for \( f,g,h \in \mathbb{R}^{\mathbb{R}^{n*}} \).
Furthermore multiplication by \( -1 \) is a lattice anti-isomorphism: \( -(f\meet g) = (-f) \join (-g) \) and \( -(f\join g) = (-f) \meet (-g) \).
For polytopal function, meet and join can be interpreted as polytope intersection and convex hull operation.
Because polytopal functions are those of the form \( \max_{i\in[k]} x_i^{**} \), the join of polytopal functions is again polytopal, or in other words, the convex hull of polytopes is again a polytope.

#+begin_proposition
For \( f,g \) polytopal functions, we have
\[ (f-g) \meet (f'-g') = (f+f') - ((f'+g)\join (f+g')) \]
as well as 
\[ (f-g) \join (f'-g') = ((f+g') \join (f'+g)) - (g+g') \]
In particular \( \GeneralisedSupportFunction(n) \) is a sublattice of \( \mathbb{R}^{\mathbb{R}^{n*}} \).
#+end_proposition
#+begin_proof
\[ (f-g) \meet (f'-g') = ((f+f')-(g+f')) \meet ((f+f')-(g'+f)) = (f+f') - ((f'+g)\join (f+g')) \]
Note that \( (f'+g) \join (f+g') \) is again polytopal.
We use this to show the second equality:
\begin{align*}
(f-g) \join (f'-g')
  = -\left( (g-f) \meet (g'-f') \right)
  =& -\left( (g+g') - ((f+g') \join (f'+g)) \right)
\\=& ((f+g') \join (f'+g)) - (g+g')
\end{align*}
#+end_proof

It follows that \( \GeneralisedSupportFunction(n) \) is the sublattice generated by \( \mathbb{R}^{n**} \).
Let \( f = f_P \) be a polytopal function and \( \Sigma \) the normalfan of \( P \).
\( f \) is linear on each cone \( \sigma \in \Sigma \).
To be precise, let \( v \in P \) be a vertex and \( \sigma \) its normal cone, then clearly \( f|\sigma = x^{**}|\sigma \).
We say that \( f \) is /piecewise linear with respect to the complete fan/ \( \Sigma \).
With this we can give a characterisation of polytopal functions in terms of convexity:

#+begin_proposition
Let \( f \) be piecewise linear with respect to a complete fan \( \Sigma \) with \( f|\sigma = v_\sigma^{**}|\sigma \) for each \( \sigma \in \Sigma \).
Then \( f \) is convex if and only if \( f = \bigjoin_{\sigma: \dim(\sigma)=n} v_\sigma^{**} \).
In particular \( f \) is convex if and only if \( f = f_P \) is polytopal with \( P = \Set{ x \in \mathbb{R}^n }{ x^{**} \leq f } \).
#+end_proposition
#+begin_proof
If \( f \) is polytopal, then \( f \) is the pointwise maximum of linear -- and thus convex -- functions, and therefore convex.

We show the converse by contraposition:
Assume that there exist full-dimensional \( \sigma, \sigma' \in \Sigma \) as well as \( c \in \sigma \) with \( c(v_\sigma) < c(v_{\sigma'}) \).
Then we may choose a large enough \( w \in \interior\sigma' \) such that \( c+w \in \sigma' \).
As convexity of \( f \) would imply \( f(c+w) \leq f(c) + f(w) \), the following inequality shows non-convexity:
\[ f(c) + f(w) = c(v_\sigma) + w(v_{\sigma'}) < c(v_{\sigma'}) + w(v_{\sigma'}) = (c+w)(v_{\sigma'}) = f(c+w) \]
#+end_proof

The statement is still true for antipolytopal functions if we replace "convex" by "concave".

#+begin_corollary
Under the conditions of the previous proposition, if \( f \) is convex, then \( f = f_P \) and the normal fan of \( P \) is a coarsening of \( \Sigma \).
#+end_corollary

We can restate the proposition for antipolytopes as well:
#+begin_proposition
Let \( f \) be piecewise linear with respect to a complete fan \( \Sigma \) with \( f|\sigma = v_\sigma^{**}|\sigma \) for each \( \sigma \in \Sigma \).
Then \( f \) is concave if and only if \( f = \bigmeet_{\sigma: \dim(\sigma)=n} v_\sigma^{**} \).
In particular \( f \) is concave if and only if \( f = -f_{-P} \) is polytopal with \( P = \Set{ x \in \mathbb{R}^n }{ x^{**} \geq f } \).
#+end_proposition


 :NOTES:
 It would be natural to ask the question whether \( \GeneralisedSupportFunction(n) \) consists of precisely those functions which are piecewise linear with respect to some complete fan.

 #+begin_conjecture
 Let \( \Sigma \) be a complete fan on \( \mathbb{R}^{n*} \) and let \( f \) be piecewise linear with respect to \( \Sigma \).
 Then \( f \in \GeneralisedSupportFunction(n) \).
 #+end_conjecture
 #+begin_proof
 [TODO: proof idea]
 Define \( \Sigma_n \) to be the set of full-dimensional cones of \( \Sigma \) and for each \( \sigma \in \Sigma_n \) let \( v_\sigma \in \mathbb{R}^n \) be defined by \( v_\sigma^{**}|\sigma = f|\sigma \).
 A subset \( I \subset \Sigma_n \) is called a /subapproximation/ if \( \bigmeet_{\sigma \in I} v_\sigma^{**} \leq f \).
 Let \( M \) be the set of inclusion-minimal subapproximations.
 Then we claim that \[ f = \bigjoin_{m\in M} \bigmeet_{\sigma \in m} v_\sigma^{**}. \]
 The inequality "\( \geq \)" follows immediately from the definition of subapproximation.

 ...
 #+end_proof
 :END:
 :NOTES:
 - motivation 1: look for linear space for deformation cone
 - motivation 2: look for linear space for right-hand side cone
 - motivation 3: leads to Lovász submodular functions, [[cite:lovasz1983submodular][Chapter 4]]
   - submodular functions \( f \) extend to convex functions \( \hat f \) on \( [0,1]^n \)
   - the points \( Ax \) extend to modular functions = linear functions on \( [0,1]^n \)
   - the points \( x \) for which \( Ax \leq f \) parametrise (some?) modular functions \( \widehat{Ax} \leq \hat{f} \).
   - CLAIM: reduced modular inequalities:
     \[ b_S + b_{S \cup \{ i,j \} } \leq b_{S\cup i} + b_{S\cup j} \]
     - cite:nguyen78_semimodular or cite:fujishige05_submodular 
 - interesting: dual problem (linear programming) and convexity
   - let \( P \) polytope and \( f(c) = \max_{x\in P} c(x) \)
   - the dual problem is: find facet normals \( a_i \) , such that  \( c = \sum_i a_i \)
   - due to convexity (and \( f(\lambda x) = \lambda f(x) \) if \( \lambda \geq 0 \),
     \( f(c) = f(\sum_i a_i) \leq \sum_i f(a_i) \).
   - we have equality, if the cone spanned by the \( a_i \) lies in a normal cone corresponding to a maximiser of \( c \),
     in which case \( f(c) = \sum_i f(a_i) \) due to piecewise linearity.
   - Hence solution to the dual problem is indeed \( f(c) \)
   - we assumed the right-hand sides to be tight
 - bizarre: infeasible systems of linear inequalities
 :END:
* References
:PROPERTIES:
:UNNUMBERED: t
:END:
#+LATEX: \addcontentsline{toc}{section}{References}

#+LATEX: \renewcommand{\bibsection}{}
bibliographystyle:apalike
bibliography:references.bib

* Index
:PROPERTIES:
:UNNUMBERED: t
:END:
#+LATEX: \addcontentsline{toc}{section}{Index}

#+LATEX: {
#+LATEX: \renewcommand\indexname{}
#+LATEX: \renewcommand{\section}[1][]{}
#+LATEX: \printindex
#+LATEX: }
* GRAVEYARD                                                        :noexport:
** Number of ray generators
**** Type A: Ranks
  - number of rays counted by dimension of the deformation
    - A_1 :: (1)
    - A_2 :: (3,2)
    - A_3 :: (6,8,23)
    - A_4 :: (10,20,115,117833)
    - A_n :: ???

**** Type A: Explicit description of \( \FacetCone \)
  - given by supermodular inequalities \( z_I + z_J \leq z_{I\cap J} + z_{I\cup J}\)
    cite:ardila08_matroid_polyt_their_volum 
  - dimension: \( 2^n - 1 \) via facet formula
**** Type B: Ranks
  - number of rays counted by dimension of the deformation
    - B_1 :: (1)
    - B_2 :: (4,8)
    - B_3 :: (9,32,15675)
    - B_n :: ???
**** Type B: Explicit description of \( \FacetCone \)

 - TODO: we define \( s \boxplus t \defeq \sign(s+t) \), where the sum in the right-hand side is interpreted as sum of vectors in \( \{0,1,-1\}^n \subset \mathbb{R}^n \).
 - originally I defined \( s \boxplus t = s\circ t \sqcap t \circ s \), which turns out to be the same
 - see also cite:fujishige05_submodular 

 #+begin_proposition
 If \( b \) is the right-hand side of a deformation of \( \Perm^a(B_n) \), then the following inequalities hold:
 \[ b_s + b_t \geq b_{s\sqcap t} + b_{s\boxplus t} \]
 for all \( s,t \in \SPowerset{n}\setminus \{ 0 \} \) and with convention \( b_0 = 0 \).
 #+end_proposition

 #+begin_proof
 Essentially an adaptation of the argument given in cite:morton07_convex_rank_tests_semig.

 Suppose the inequalities don't hold, then for some \( s, t \) we have
 \[ b_s + b_t < b_{s \sqcap t} + b_{s \boxplus t}. \]
 Then we conclude for any point \( x \) in the deformation \( P(b) \) corresponding to the right-hand side \( b \):
 \[ \sum_{i=1}^n (s\sqcap t)_ix_i +
 \sum_{i=1}^n (s\boxplus t)_ix_i =
 \sum_{i=1}^n s_ix_i +
 \sum_{i=1}^n t_ix_i \leq
 b_s + b_t < b_{s\sqcap t} + b_{s \boxplus t} \]
 So both inequalities 
 \( \sum_{i=1}^n (s\sqcap t)_ix_i \leq b_{s\sqcap t} \)
 and
 \( \sum_{i=1}^n (s\boxplus t)_ix_i \leq b_{s\boxplus t} \)
 may not hold as equalities for the same point \( x \)!
 (TODO: clarify the following argument)
 However, as \( s\sqcap t \sqsubseteq s \boxplus t \), we can find a partial order on \( [n] \) and a "marked" subset of \( [n] \) which is compatible to both \( s\sqcap t \) and \( s \boxplus t \).
 This gives us a maximal \( u \in \SPowerset{n} \) such that the vertex corresponding to the cone \( \overline{C}_u \) satisfies both inequalities with equality.
 #+end_proof

 - TODO: does the converse hold?
   - computations for \( B_2,B_3 \) suggest that it does
 - TODO: Not all "signed submodular inequalities" are facet defining (as was already the case for A_n)
   - how can I reduce (drastically) the number of inequalities?
   - can I give the number of facets of the deformation cone?
